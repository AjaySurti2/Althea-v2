import "jsr:@supabase/functions-js/edge-runtime.d.ts";
import { createClient } from "npm:@supabase/supabase-js@2.57.4";

const corsHeaders = {
  "Access-Control-Allow-Origin": "*",
  "Access-Control-Allow-Methods": "GET, POST, PUT, DELETE, OPTIONS",
  "Access-Control-Allow-Headers": "Content-Type, Authorization, X-Client-Info, Apikey",
};

interface ReportRequest {
  sessionId: string;
  reportType?: string;
  includeQuestions?: boolean;
  forceRegenerate?: boolean;
  insightsId?: string;
}

interface ReportSection {
  executive_summary: string;
  key_findings: {
    genetic: any[];
    lifestyle: any[];
    risk_factors: any[];
  };
  abnormal_values: any[];
  health_recommendations: any[];
  family_screening: any[];
  follow_up_timeline: string;
}

// Althea Logo (base64 encoded JPEG)
const ALTHEA_LOGO_BASE64 = "/9j/4AAQSkZJRgABAQAAAQABAAD/4gHYSUNDX1BST0ZJTEUAAQEAAAHIAAAAAAQwAABtbnRyUkdCIFhZWiAH4AABAAEAAAAAAABhY3NwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAA9tYAAQAAAADTLQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAlkZXNjAAAA8AAAACRyWFlaAAABFAAAABRnWFlaAAABKAAAABRiWFlaAAABPAAAABR3dHB0AAABUAAAABRyVFJDAAABZAAAAChnVFJDAAABZAAAAChiVFJDAAABZAAAAChjcHJ0AAABjAAAADxtbHVjAAAAAAAAAAEAAAAMZW5VUwAAAAgAAAAcAHMAUgBHAEJYWVogAAAAAAAAb6IAADj1AAADkFhZWiAAAAAAAABimQAAt4UAABjaWFlaIAAAAAAAACSgAAAPhAAAts9YWVogAAAAAAAA9tYAAQAAAADTLXBhcmEAAAAAAAQAAAACZmYAAPKnAAANWQAAE9AAAApbAAAAAAAAAABtbHVjAAAAAAAAAAEAAAAMZW5VUwAAACAAAAAcAEcAbwBvAGcAbABlACAASQBuAGMALgAgADIAMAAxADb/2wBDAAMCAgICAgMCAgIDAwMDBAYEBAQEBAgGBgUGCQgKCgkICQkKDA8MCgsOCwkJDRENDg8QEBEQCgwSExIQEw8QEBD/2wBDAQMDAwQDBAgEBAgQCwkLEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBD/wAARCAQABAADASIAAhEBAxEB/8QAHQABAQADAQEBAQEAAAAAAAAAAAECAwQFBgcICf/EAEkQAAICAQMCAwYDBgMFBgQHAQABAhEDBBIhBTFBUWEGEyJxgZEHMqEUI0JSscHR4fAVM2Jy8SRDU4KSsggWZKIlNDVEc3TC0v/EABwBAQABBQEBAAAAAAAAAAAAAAADAQIEBQYHCP/EADYRAQACAgEDAwMCAwgBBQEAAAABAgMRBAUSIQYxQRMiUWFxBxQjMjOBkaGxwdEVJCVCUlPw/9oADAMBAAIRAxEAPwD/AFIAAAAAAAAAAAAAAAAAAAAAAAAAAAAceIAC4+DAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABEqKAAAAAAAAAI1ZQAAAESooAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAI1YSooAAAARuigRqygAAAAAAAAACNWUAAAAIlRQAAAAAACJ2UAAAAAAAAAAAAAAAAAAAAAI1YFAAESopEqKAAAAAAAAAAAAAAAAAAAAAAAABG6KCJUBQAAAAAAAAFw7Evik2AAAAAACNWUAAAAAAAAAROygAAAAAAAAAAAAAAAAAAAAAAAiVFAAkRIoAAAAAAAAAAAAAAI1ZQAAAAAAAAAAAAAAACN0BQAAAAAAAAABEqKAAAAAAAAABG6KAAAAAAAAAAAuS7MAAAAAAAAARuigAAAAAAAAiVAUm70KTb6gUAjVgUAAAAAAAAAAAAAAAAAAAAAAAAAALkuzAAAAAAAAI3RQAAAAAq2/xOgIRKigAAAAAAAEboCgAAAABE7KAAAAAAAAAAAAAAAAAAAAAidlAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABEqAoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACJUUAB8hulLuwAAAAAAAAAAAAACJ2UETsDK/hcfMgAAAAAAAAAAAAAAAAIlQFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAARuigAAAAI3QFAAAAAAAAAAAAAAAAAAAAAAAAAAAFW3xjf1IABG6KAAAAAAAAABG6KAAAAAAAABG6KAAAAAAAAAAAAAAAAAAAIlQFAAAAAAABEqKAAAAAAAACNWBQAAAAAAAAAABGrKAAAAjVlAEasoAAAAAAAI3QasoAAAAAAI1ZQAI1ZQBGrKAAAAAAAAAA+Ye3wdgAAAABEqKAAAAAAAAAAAETsoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACN0BQAABG6KAInZSJ2BQAAAAAEasoAidlAAAAAAAAAAAAAAAAAAAAAAAAAAEasoAAACNWUAAAAAAAAAAAAAAAAAAAAAI2kBQCJUBQABGrKAAAAAAAAAAAAAAAACJ2BQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAXJdmAAAAAESooAAAAAAAAAAAAAAAAAAAASRQAAAAAAAAAAAAAAAAInZQAAInZQBGrKAABG6AoAAAAAAAAAAAEasCgAAAAAAAAAAARqwKAAAAAAAAAAAAAAAARKigAAAI1ZQAAAAAAAAAAAAAACJUUACJUUAAAAAAAAAAAAAAAAAAAAAAAAAAAAInZQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAI3RQAAAAAAAAAI1ZQAAABcOwAD7t+YAAAAAAAAI1ZQAAAAAAAAAAAAAAAABEqKAAAAAAAAAAI3RQAAAAAAARugKAAAAAAAAAAAAAAAAAAAAuS7MAAAAAAAAACN0UAAAI1ZQAAAAAACN0UAAAAAIlRQAAAAAAAAAAAAAAAABGrKAAAAAAAAAAAAAACJ2UAAAAIlRQAAAAkigAAAAI3RQAAAAAAAAAAAEasoAAAACJ2UARuigAARqygAAAAAAAAAAAAAAAAAAAAAAAAAAAIlRQAAAAAAAAAAAAAAAABX/u38yLsAAAAAidlAAAAAAAAAAAAAAAAAAAAACrb/E6AgAAAiVFAAAAARKgKAAAAAAAAARugKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABGrAoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE2+pQAAAAAAAAAAAABPz/ACgAAAAAAAAAAAAAAAAAAABb+Fx8yAAAAAAAAAAAABGrKAAAAAAAAAABGrAoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAI3RQAAAAAAAAAAAAAAAAAAAAAAAAAI1ZSNWUAAAAAAAjVlAAAATb6lJt9QKRqw1YasCkasoAAAAAROwKAAAInZQAAAAAAAAAAAAAAAAAAAAEasCgACJUUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACbfUpNvqUAAAAAAAAAAAI3RQAAAAAAAAAAAAAAAAAAAAAjVlAAAAAAAAAAACJUUAAAAI1ZQAAAAAAAAAAAAAAAAAAAAESooAAAAAAAAAAAAAAAA48QAD2+DsAAAAAAAAAALkuzAAAAAAABGrCVAUAARKigAAAAAAAAAAAAAAAAAAAAIlRQAIlRQAAAAAAAAAAT8H28gBEqKAAAAAAACJ2UAAAAAAAAAAAAI1ZQAAAAAAAAAAAAAAACN0BQAAAAAAAAAAAAAAARqygAAAAAABcOyy/OyAAAAAAAAAACJUUAAAAAAAAAAAAAAAETsCgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAjVlAAAAAAAAAAAAAAAI1ZQAAAAAEasCgAAAAAAAAAAAAAAAAjVlAAAAAAHyFyfd2ABGrKAAAAAAAAAAAAESooAAAAACJ2BQRqygAAAAAAAAAAAAAAAACNWG6KAAAEasoAAAAAAAAInYFAAAAAAAAAAAAAAAAAAAAAARuigAAAAAAAAAAAAAAAARKigAAAAAAAAAAAAAC+QAAAARKigACJ2BQAAJEpJAUAAAFy6Entk0AAF14J/MAAAAAAAAAAAAAAAAAAABEqKRugKAAAMWqMgAInZQAAAAAAAAAAAAESoCgAAAAAAAAAAAAAAAAAAAAABG6AoAAAAAAAAAAAAAAAABG6AoAAAAACJUUAAAAAAAESoCgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAjdFAAAACN12CbfdlAAAAAAAAAAn5SgAAAAAAAAAAAAAAAAAAAAAAAESoCgAAAAAAAAACSKAAInZQAAAAAAAAAAAAAACJUUAAABE7KAAAAAAACbvQNWRqgIAAAAAAADJOykiROgMgROygAAAAIlQBKigAAAABGrKAAAEbooAAAAAAAAAAAAAAAAAAAAAAAAAAAACJ2UAAAAAAAAARKigAAAAAAAAAAAABGrKAAAAAAAAAAAAAAAAAAAAAAAAAFyXZgAAAAAAAXJdmAAAAAAAAAAAAAAAAAABG6KAAAAAAAAAAAAAAARKigAAAAAAETsoAm70DdGIAAAAAAAAAAAAAAAAAAAZgxbsu70AoAAAjdEbsDIEiUADAAZgAAAAA58AADcn3dgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKtvjKvoQAAAAAAAAAAAAAAAAAAAAAAAAAAAABe3D+qAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAI3RQAAAAAACbfUbfUCgAAAAAAAAwAAAADMwM3x4ASRiVuzB5IoDIGvevR/Ie8h/FJL5lJmIWzeI92wGPv4f8AiR+4999fkU7oU76/lkDD3sW6pr5oz3IuXROwABUAAAAAAAAAAGZgZgDAAAZmBmYAAAAAAGSdlMDMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIlRQAAAAAAAAAAAAAAAAAAAAiVFAABv4Vx/EAAffgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAARKg3QFAAAAAARqygAAAAAAAiVAVcOw+7fmAAAAAxbsN2QAAAABy9T6roOj6Wet6lq8WnwwVynOVIpMxWNytveuOO686h1HPr+p6Hp+B59dqsWCC8ZySR+N+2349R0ylpfZrA18W39pzR5kv8Ahh/dn451z2w691zPLN1DqObM5u/inf2rhGl5nXMHGnVPMuJ6v644PAmaYfvt+ns/onrv43eyXS3LFpHm107pe7W2D/8AM/7H591b/wCIXq+pUsfStJp8EV2bW6X6n41m1E5Scpc/U1LLfgc1yvUmef7Hh5z1D1/1LkzMUnsj9H3+v/Fz2x1qbn1fUQiv4YNRT+39zxsvtj13VJZMnV9RK7pPJJ1z8z5hZXGLRHqG+X3XZ+XNGjydX5GT3tLmM/XefyJ+/LP+cvpF7V9WX/7/ACr5Sb/udek9uvafTfHh6plSf8O5nyEdQ0+VdmX7VJflSXz5LK9Uz1ncWlZj6rzsc7jLP+b9L0P4w+2Ol5fVss/SXK/W0fZdK/H3XYHFdX0GHLFcSljvHL5+K/Q/A1q5t1aXySOqGtnd2vJJ80vI2fG9QcnHPmzdcP1d1XiW3XLM/v5f1n0D8VvZPrmyH+0FpM0+Fj1NQTfkpXTPsMeaOWO+PKZ/EmPW3bU1XhXj9D7T2O/E/r3s7thoupSzafx0+duWOvTxj9DpeF6hpl8ZY8u76T/EOuWYpzaa/WP+n9VA+I9i/wAUeg+1ahpZ5Fo9e1/ucs1U/wDll4/Lufbp2dHiy0zV7qTuHpXF5mHmUjJhtuAFohIyQAADKJiAMwTd6CIFBHT8ewjLb4FJnQJUYmTVmJUADLb6gYgAAZmBU6AyAAESooAC5eDoAAAABEqKAAAAESooAAAAAAAAAAAAAAAAAAAACNWUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAjdFAAAAACNWBQAAAAAAAAAAAAAAACNWUAAAAAAAAAAAAAAAAACJ2UAAAAI3RTFuwIAAAKfF/iH+Ieh9kNJ7nHsy67LBvHjlVQX88vTy8yLNmpx6TkyTqIY3L5eHg4bZ886rDq9uPxD6P7F6HfqGs2smrw6dNbn5Sb/hj6n82e2H4hdb9q9VLUa7WJ1axwXEMcfKK8/Vnj+0ftLrOt9QzarX6nJly5XulKcrb/AMF6Hy+q10d+2UaS7cnnXVvUd89ppSdVeEepPWmbqtrYsM9uOPj8u2Ws3ym55N22nz69+Tl/aVjrJsumlVnmftLpvJ4eKTr7mt6mOR7YRqMeys5TLz+7fny4K/Im0729BaiKioylclfbt9PQSz7lV+FHnxyptXwZZckkuOU+Pp4kEcnu+Uf1Jl1PU5Nrd2k6rzMJ6h8Lt5xT+1PucvvX2Tr58Ec4rc1BqlZX6qsOxaqbfPHqu5ks7fi2vV/68Dji9yteW4yU77Fv15hWLS6o50k17zu77Feoc4JRbVtLvTTvk4pT4covs6Xcw963zGbukq86L4zQfUnb1Fqoq3OO1K4t7rN2PquySn7ySku1Rb/14HgS1G6UI492+Sp2q3PzND6hcXCU3Uu6MrHzYrGktM3b5fddN9oJQlL3k6cHzT7ep+0/h1+NuXQrH032m1E9TpuIw1O65w9H5r9fmfzRo9Tk3RW/fDuk/BnuaDXzhzKbaXZeR0HTutZePMTvw6bofqTk9NyRelvH4f3lpNXp9bpser0mfHlxZVujKErTRtP5l/Cr8UtR7M6iGk1eWWXp+VpTg3+T1Xkj+lNDrdP1HSY9bpMinhyK00z0Lhc+nNx99Pd710TrWDrOCMuOfPzDcCshnN0ANWAAAKTOh5PVOv4+l6zFp88H7vJHdKafbnyPUw5cefHHLhmpQkrTXifO+2uBfsmHWRXxYp7X8n/nX3PnNB1TW9Mm5abJ8LfxQfZnPcrq89P5PZmjdJ+WvycuePk7ckeH6Xy2Q8rontBpeqwUOceWK5hLuj1ndm7wcjHya9+OdwzMeSuWvdX2QGZgTRO0gG6InYasqMQABlEpIlAAAAAAAAAAjVlAAAAAAAAAAAAAAAAAAiVFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAROygAAABE7KAAC4dh8ycvMAROygARuikasCgjdFAGBlIxAGLdmRhqNRi0uDJqc81DFig5zk/BLljxEblSZisbl4Ptx7X9P8AY7pGTqGrleRprFjvmT/wP5O9pPaXW9c6hqNZqtRLJkzScpOTun5fJcHvfi97d5fafrs5rLOODTtwxwT+Gu3Pnxf3Z+Y9Q12N4l9Tzj1H1ac15xUnUQ8H9d+pp5meeFgt9lff9ZNTrlcpv+FvvLueLrNeltck5qLatcpS/v5mGr1cacXJTim43Hmn5nnzzyUkov6/T/M8z5/Uox7jbyrNyYp7ulZ4vuq/v6nRhlLmpKPzfh4HmKV+B26aTnBPm4p1SNHg59suXygpn7pdlyeRRql4M2Qb7VwcqnkTb4d88d7NympKL8/0N7gy90M6mvdk62XF2nTceeXfBYyfvFcXXd35+BgptOLj4KuPRcETU096XrRnd3hPWG174/7xcbdzfFrn5fIw95KKuMd1NePD9DBTdY4Kkk/HmmYynKT44TbaXl/qi2Z0raIj2bt8pJwfFOqT8TVk27Uqtp2RSjs725dzB3KGxSSaZi5cswxrZZiWrU5KjFOEWrSbZ5eqbwZpwi+G7XyPUzSUY3w7+H7/AOux4+rk/eOM3ym1tfdGt5HJvVi5s0x5btNrp45rng9rSa+OScZL40/zJOl6f686PmJS2m7TZY+8WNtR3dn4oyuF1a1bRW0q8fmzWX3/AEzqnus0J43teNUqjSP3n8FvxOlpNRj6J1HLvwZ+IOTtYX5/8r5+p/MGm1clFTxr4ZJNc2n/AK9eD6f2e6vPSauGV7oqDVp/xK/8kdx0jrk8XJFon3dZ0D1Lm6Pyq5Mc+J94f39GanFSXjyg3Z8F+FntjD2g6HDTanKnqdMowbb5yRauM/qv1s+7iz1nj5a8jHGWntL6Y6fzMfP49eRjnxaFBN3oVOydmROyMvQybowiZN2FXm+0On/aOk6iKjcowcl81z/Y/PYz94mqr+L7n6hnhHLjljl2nFxf1VH5Rn/7PkyaeXKx5ZQcXw00zk/UWKLWpb8tL1SNTFljlzaPMs2nnKLjzcXyfc+zntZpupQjptVJQzVw74n/AJnwjyp8rsce/JpMrUW1CTvg5ni9Ry9Hy90eaT7w12HmW4lt78P2uLu+KFM+T9lParHq1j0Guyr3r4xyf8R9Ymei8Tl4+XijLi9pdLgz15Fe6qAjhXiUzYnaYMDMwAySooAAETsNWBQAAI1ZQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAiVAUAAAAAAAAjVlAAAAAAAAAAEbooAAAAAAAAAAATb6jb6jb6jb6gUAATd6FAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACN0UGLdgQAAD81/G72t/2H7P8A+ztNlS1GqTk0nyor0+f9EfpMpbfA/k78bfax9f8AaLU7J7sWH4I/S1/j9zV9X5P8tx5n8uZ9WdVjpXTrXifunxD8x6rrcsssoy+LxfP9fU+d1/UMiUfgfCbSbff5LudOryxjjk4zT3c1T7eB87q8ylJc7n/E/Bs8S6xyppFrRPl8wcvLOS9r3n3bG7MW/U503HsZxyen6nn+a9s1u6zR5Jm0+XRu9Do0kHmxxnji3tm78F6c3z2OCU68D0tNlyS0+NbMcU17tTVNpJd6+dl/HrE2X8WsTaduiEZxlubdeP8Aib1KG1vwurd9n4nJF/FWaLS270lJJ18n/Qz94oqUpR5S/ijzRvsGT6cabGl+3xDqltcUoU677nwzBye34pRflRgpZpbYpR5SbS7fcJ96XCdOnacvD+vzNhTLtlxeIhmskKddo9nJc/cxb8aMHL3mPlJLvwqaaJ7yk3N16svvk/C299+zJN7oxlGlfcTntjaSdeT8DXPI4ttPbaavl/Ix3/Ely1K6brsYuW8MbJaNsNTL4bxTtrwrvzR5OtWWGplHJjeOklGL8q4O/JljDDCUsqyQkqpPh35p+P8AicOqlGT37ZKf8Sck+f7Gn5F62YWa0eznlLjsa3k59UVuzVOTUqMSvjyxaTqXdptfkg1HLO4RSSj5/wCv7HsaDX5I7dVkiqn8UlKpOFP83NfavI+XU68D1tC3mi/eU5SpNtcJef6m04/LtWdSnjJMP6H/AAb9spdP6hp9RPJfuWoZYX+bG6d16Pk/qnBq4ZoLJjalCSUk14pn+fv4a9cel1sNDmySlt+BuSq/P9P6H9lfhb199W9nseHNPdqNK/dSvu4r8rf0o9l9D9YjmYp49veHvv8ADDrk5+PPDyT5r7PvU7M07OTHlo3xyKS4PQXrm20yNe70Mk6C+J2yPyf2g/ce0Gvwt/u1m3+XEkmv9eh+sbuO3Y/Jfb1KPtPnbf5seKb+dNHM+qZmnEi8fEtT1f8AuYn9XFCdRSd7lw0+8X5s1uazKKnH/eK077GnHnlvUp8pS2m3JBw280qtR8o+ZxeTWbFtz1pi0ba8eXNosydtxXb/AF5n6N7Ke1kNfHHoNXkXvXxjk3+b0+Z+bOs8XCS9L8UadLrJ6TLzJx2v8y8PUg6V1jJ0fNFZneOf9F/D5l+LePw/fFy+wPnPZD2lj1jTrS6ma/asauT/AJ15n0d2es8bk05WOMuOfEuww5q56d1Am31DVlMhKwAAAAADMwMwAAAAAAAAAAAidhqygAAAAAAAAAAAAAAAAAAAAAAEasoAAAAAAAAAAAAAAAAAAAAAAI1YSooAAAAAAAAAAjVlAAAAAAAAAAAARuigAAROwKAAAAAAAAOPEAA9vg7BEqKAAAAEasyr4XLyAhgVuyAA+AYyXHcDxPbTrH+xfZzW65cShjai7/ifY/iv2l1ss+oyZZS3ScpW/qf1H+NnU56f2djpYWlmc5P12x/zP5L67m3bnVbnbRw/qjl6n6bxv+I3Nm+WvHj2j/l871HUTalz3VceH0PC1M9+R8VTo9XUzk8uSdWrs8XPK8ja8zxzrWXfiHinNn4hlEyTo1xLGXoczMNRv4ZSdm/TZ4xUYTxuW2e6l/E+1fqzQnZItxe5PtyvmVraazuFceTte3OObJKW+EuLtWnUkuLfn3E5x9092PZSSpy3Jrz+Zy6TNGfMtsvdxfiopqvD/Xgb8u9YmnBRTpPZDnxTk6Nphyd0bZ9L/Lbcnv3Jb4STbi+ZebvwG6O1zUpRUZW3K4peS8TmyTrct/wY21CNfC3tt168ibyRxzbaytrbaqrqkvUzIy695ZEZY9nTk+LC4+EW1JeaMEpbsjmqjFxbT7tc9w3Ha8cJxafk22qj3t97ruavz7cvfbthb53y78+nqVnPERvZbJEezZPe+HcY76S9PMm6TalDIpPbxvnSV/17Gr4I3JY6ju4j8XMX61fgaMs5RxRhihBy2ykrfEV3q/Uw78n3Y18vdLLN7ucoSxfDsuL4fxPz44558Di1GR7tr8CyfKbht2rbGpdkapvdz5GttbvtuWuyWm1p21qW66RoyO2bpHPJ2y+F1YE6O3p3xZnF8pLlcdvHv/bk846dHKbzxWOW2TdKu5k4p1ZkVe307Nl0HXMerxz+HJUpxSaSlwmkf1L+C/tJGPVMelll+HXY+PNzjz+qbP5X1eCM4JxlKNJT4fDauuT9Y/CL2hyYdR07VPNtlgz47l/wtpS/RnTem+fPTep0nfiZdt6I59uD1WkR7S/siOSjfjyVTPL0uSo7X4HZjm1R9FRO42+n4vvy9CE78DZu9DjhLjsb1JMTOksS3buOx+T/AIlKUParGk6UtJD+sj9TbruflX4mTUvanHz20Uf/AHSOX9X2102Z/WGs6xOuPv8AV4OHPe7hVXPJ25nN6aOXOlkc+Nyfb5njwlsvl8nq4pyngmt7adfAnS8/oee9Nzd8TWZc1it3eJaJuWlyue61+jRzajvuSpvx8jrljxTcIbkoNv4fTnn0rk45RtvH4pcGNzKb3pZaNuvo3Vc2gz4smLI4TxO4yT8T9q6H1jB1rQx1eJbZdpx8mfglODpn1fsN7ST6Vrks828c/hmvTzOi9K9bnj3ji5p8T7Nn0vmzgv8ATt7S/YHwYqXoIZ45IqcaaaTTXkQ9RidusZk2+pSNWVGIMtvqNvqBiZRMQBmCJ2UAAAAAAAAAAAAAADjxAAPb4OwABEqKAAAAAFW3xlX0IAAAAAAAAAAAEbooAAAAAABG6KAAAAAAiVAGrKAABG6KAAAETsNWUAAAABEqKAAAAAjVgUAARqwlRQAAAAAAAAAAAE2+pSbvQoAEasN0BSJUUJAAAAInZQBgAABrySpdjPt4mrO/hA/GPx31b2YMEGqjgcvu/wDI/l7r2dJe8aai27flT/U/pL8dnL/aEYLi9Lf23H80dcW/Nul8Pu73LwVvg8w9T5Jjk2iXgfru8259tvEm7m335s8Sf55fOj1cvd+js8fK/jvxPLurVncPKOZE72z3eg3ehpUvQu70NHMba3X6t0Zehlu9DRGXoZp0WzVbaNeXRhcd2ycqjLvwraPRnPfhc8eKeT4ozcowaUpfy97Z5W70OzTdSlp9i28QjOMdrppyrm/PivkyXBaInUzqE3HtWZ1edQk8iw78OXC4zi9u2T5g13XNt2b8WSCm3GdRglOKm/Dy4ur8Dk1mpWr1OTUNKPvJOW2u318fD/I1wzOMZY98lGXdJk0ZorM78qzlitp/D03lhLIsuJ4pS/hhztivC2+77/oYRypSxTm3BynxLv8ABTTabXocTzvwX+ZjvvlkF80zO1Jzbnbryahbdy/d1JriTt/fsjlnmW9vzRq326rsYSl8XbwLZja233TtnOTk+5rn2Md3oSUvQpFdI+1ryOmarpsykYSdWS1hLXwhlCSTqSuPjT5Naly+CxW+ajuUfVvhGRjr5S443L6yEITwQlNWpQdbnbSrwf0Pa/CvWOOXLD3l7Ipr5pnzOlzbYxUpXGXj/wAVc/Xk9D8OMqw9TyY4z/NuTZn0pauWuSvxMOj6TSa8ul6fEv7z6Lq3qtBg1F/73FCX6I9jBNuPPJ8h7J6icui9OTdXpsX/ALUfT4Mqa+R9J8PJN+PSZ/EPqjhX7sNZn8Q9HHOl2N2PizjhPwo3RlfgZbN94b/ebmvA/KfxKk37UtL+HRwr1blI/UqvxPxv26zSl7Z61LjZDFj+0b//ANM5H1nkinT4r+Zhp+s3iuDX5l5kJRctrdf1o9DTZbx5E7r4bSfD7P5PseWpcOVc7afqehpNzx7Yz2vHLu34eLo804Vuy+oc5SUzxm8sPeKts36qLT5S8GaptNuSe2V8KXejuycPTybcIyVZLj2k01f28UcOaMktkknKD27l2b/wqvkZXIiV0y1Zlua58CYM0tLmjmi72+Hay33T7o1ZYU00+5r5tOO0Xp7wtftPsX1ePUOmxwSnuliS2+sPD7co+kPxz2G65PQ62OOU3t7V5rxX25+iP1/Fljkgpw5jJJp+h7H6e6lHUOHW3zDrum8n6+KK/MN5NvqZRd/QhvonbZABi3ZUQAAZRKSJQAAAEbooAAAAAAAAAAAAAAAAAAAARuikTsCgAAAAAAAAAAAAIlRQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAESooAAAAAAAAAC5LswAAAAvw+MqIRqygYAADBujXk/KZyNeb8v1Cky/Evx0xf9r0efv7zTyV+fL/AMT+Yev4VHLNylHlt8uuzfD9D+rfxz08paHp2q71LJjl82k1/Rn8te08JQyZYzjtiu78Uu7bR5h6nrP83bbwn13hmvPtMvksk4xUt03sil8Mm3atctrv/ieXqYx3p44yS55aq+b/ALnoZZfG5V+ajztVH41/l3+nB571XH/T8PK+ZjmY8NT4YMd3oE6OZ01nbLOMtvgbIukYJ2Nyffgt91lqs91rtyZ7n5nOZOSfgWzCK1PmG62LZpHvPQppZpv3eg3tduDn3eg3ehXULqw2OflK2Xc/M593oN3oXTtLENu6XmaZSl5k3ehqlKqLq0lXslnKXoYS5MXO/Awcm1VE1aSkiC7bM4vvwao8N+puwRbnwo8SX5u134+hlYqeU+Gv3PazZ4097W6KT3J25Pzfl2PR9g1PJ1PJNzSjjg2+Oy7s8TWZo4YSTVr5vv4rk+j/AAyxTy5sihy8uRQivVszKz/UrWPmYdH0ebfzcVj5f2f7LNw6Xosbknt0+JX2v4EfU6bJ3PmelbcOLHDwilFfQ93DkrhLufRfD+3BWs/EQ+neF9mOsfo9bFPxOmEuDzsGTlJnVjlw6Mvemfvxt17/AEPwnqut/b/aHq+sXO7V5Ir5R+Ffoj9i6lr4aHQ6jVzdRxYpTa80lZ+F6DJKcHPJ3nc2/NybbPOfX/LitcOGv5mXNdby77KQ7t6jBy7+h7mijs0k8EYOU5L47Vyiquvr2+h4Ud7jGSlVq+3Z33PT6XPZmcXbjFU0pJOV/wDQ4fh5ojJG2ppLrzPLgzYlUKxO43G0lK+K/X6nPqPeR97i+CT3JuXjFS8Pqd2oyY1COTIoTdbnVLcre2a8lS55+nlxZ8ccefUYnnUZ48StRurT4a47V9vqbXlUmsTC+XnJya5VMso7sbqSVeYn3tLv5GFprlGkiZ3qVYjbPp2qen1MckXTTP2n2P6j+3dP2uV+6dL5eB+Gz/dTtfQ/Qvw+617rVwwTyfDlTh9WuP6HVekOfPH5f0bT4lndOzThz6/L9STsy3ehzxk348GxOj16J26+J2yMt3oYbvQpVVlESERICJWZGBmAAAAAAAAABEqKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAARqygAAABE7KAAAETsoAAAAAAAAAAAAAAAAAAESooAiVFAAAAACJUBQLkuzAAAAAABgAANcjVN1GjbI1SA/Pvxi6f+2+xuXUKG6WjzQyv0i/hk/wBT+S/atfFOfkpceB/b/Wen4urdM1XS88U8erwTwu/ByXD+9H8be1vTM2OebFqcW3NinLHli+6nF7ZfqjgvV3Gmlq5/y8n/AIicOYvXk19pjT8q1mBQqcfG5N+atU/1OHVcfRnsa/Et+SE4fkbv5U7f044PF1CcYp3fh+iPOOTX6lJeN567hzN14GG70Em137Gpzr/qc1m4819movi03Rl6GfvK8DnjNsy3vzf3MSaoLVbVKvAbvQ1b2N7KdiPTbu9Bu9DT7z5k94/L9Sv05U7YdfvPQKXoc29mPvh9Pana2yl6E3ehq30YPJfZ0X1ptfFW3d6GEpXRqjK7sxcvJE9Mf4SRTbOU9vZdzGEk5ba7mqUvQRl34J4xJIo6J/M6NFiWXJBbk9icpx8/J+r8/wDM5Ib3UEvrTPR0qlhwuKd76l635fQyMVIjzLI49fuTrmdXsne+Xf8AQ/QvwR6fPWda0OFRtRz+9n8oq/60vqfmfWZzefHCWPbU+9t2vFn73/8AD30SX7JqOs5EkpXhxWufNv8ARG76NwY5fMxxr2mJ/wAnbelOn/zPMreX9FaKdwjwevgyRcrUro8DRTrB2PX0s9sYzPcMdvh9B4a+HtYpurqjdvZw4ZyvvwdKn4NGTEsi19Q+a/EzqUtH7NT0mOajk12RYe9fDTcv0X6n5lpobIKu7Pc/EXq66n7QR0ON7sWgjtddnN8y/wADwoSSkr7LwPDvV3UI5nVLVrO4r4hxfOzxn5MzHtHh34JXHa/A9HplvPBxjjm5P4VPs3/pnm4EpRfB7XRsePJroLNJxgnfD8V5+hq+BHfmrCOvmXpavlKORTwwx8tRak02+dvj3Xaub+/BrccMGpyZJT3vLivK48yi33TXftz/ANTt1LhhyP3MaWWUJzbjwpLxXz7s062Upe4nLEoze+O3+Hfzy34q1a+fPY6jk9tqz+YTzG5eJkeye380H9LNcntlGPdSv9DZl4jiT7Jp36NHNncnW6V9zmrxqRM/KTXgev7M62WDUqp7XacX5STtHh5r2m3p+d4M6d9yTg5pwciuSPyRM1mJh/Qmg1a1Wlx6mErWSKkjtjL0PmPZHVPU9LWPm8Utv0fKPpk7PfOHl+vgrk/MO14+T6mOLNhkYmRksgAAAzMDMAAAAAAAAAAAAAAAAAAABGrKAAAAESooAAAAAROwKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEbooAAAAAAAAAAAARqygAAAAAAAAAAAMAABg1ZpyRvx7G9qjVNUBwZex/O/wCOHs4tB7QPXYoJYOsY5Zd1cRzQXxr5tU/uf0Zlhb+Z8X+JHsv/APNHs5n0GLGnqsT9/pX4rLFOl8pK0/mavrHCjn8W2P5+Gg9RdOjqPBvi1594fxD13Sbcjk488qXrV3/RHzepxbE4t9uzP0j2o6fJZJZfduPNyi+8ZLiUWvBpnwurwJp0uGmvl/pcfqeLZsU4rTS3vD5r5OKcWScdveHhZNqdOqSS3eBzZPNHXnxqKac48c1zz6nLK7fo6Ndmw7a3NT8te/nsZRn8jVOuKJZrr8aI8sWaRLosw3MwcmTfRHOKEU0020VqzT73zRPeL+Uimn4RzTU6bLXmRuv4ka/eV3v7mv3iKfTkiky2ylRjv80atxjKdd1RLXCkijbGRJSo07kvykvcT1xdvskirbu9Cxl8vq6NG70M8b+LcnTXZkvbOl/a9DBL3cXJ/nq/lRtx5Ky9vyJR7+Jwwltv/l2mxZo44rLLw8CXj45yZYoy+HhnNmisNGrWXWdS0fT9LGMsmTJsUVdybfzP7J9gOkYegdF0XScaSlgxJZOO+R8yf+vI/mz8EfZ1+0PtNl9pdXj/AOx9Pl+7tWpZXaX0Xf7H9RdIbjjWRtto9Q6J0+mC31deXt/pbpUYJ+tr9H1WjySXw+B7Wnkmk12o8PSP8sv5v6Hs6SSqNnYU93oFJ7Xq4JuLSvsa+r9Zw9G6dn6lqJpY8EHJq+ZPwS+bEJd1XY+B/E7ray6nB7PabN/uUtRqOL+L+Bf1f2MHr3U69K4N88z51qP3YnP5MYME2fIxyzzTnqssnLNnnLNOT8XJ2zqxwjxOfNHNp475crhcnfhxyyyjBLi7fry0fPndbLaclveXGY5m090u3FsWPbHu+57vSv8As88+XdFqHPD/AE+vJ5elwylHHjcZRc5KKVcyT8j1dLHHDHlw7lGeOO6n2dd7+XKZv+nYrUvFpZtJ8ujK5Q1E4QjCKbjJqUvjUE3tpPjxk/oatXK8U474x90090Y/nm02nXhVcmUskcmbBDLj94pXNfElFu+ab8O3DNeqzy3xytVmUffZHKP/AAult+Tp8m8yX1SZTQ8bNuivjpy3X53fN/r+hyO3u+ZvlKLpbdriqrwSOecowdNPnyOcyTuVYjbDLxjpeBrwyfv8bfgzZkdxNEOMsUQ90xMSpfzD9e/D7Xb8WTDv5lCMq9Vw/wCx91i55Pyz2A1Uv2uOJO/hav8AX+x+pYX3Z7j6Z5P8z0+sz8On6Rk7uPDoXBma4yuKZnu9DoW3UAADJOzEySoCgAAAABG6KABE7KAAAAAESoCgAAAAI1ZQAAAAAAAAAAAAAjVlAAAAAAABGrApE7KAAAAAAAARqwKARugKAAABIgUAAAAAAAAAidgUEbooAAAAAAAAAAAAAAAAAAAARqygAAAAAEkYmZNvqBiYyiZBqwOLNCrZ52eClb713PYnC40cOoxKPxL6hZMbfzz+OP4ebYZvaXpOL91klv1uKK5UuP3qXk6qX38z+cOo6aWKbjVcV9T+++p6XFlhkx58cZwmnaa4aP5b/Fn8OJ+z2ulqtFhctBnt4nFcYuG3B/2fiecereiTj3zsEePmP+Xjvr70zak/+R4lfH/yj/l+F6vT+L5a8fJeB5WfHKM6ca3f2R9RrtHPC6yQ8/6Hh6nHJNx2uVd/ir6N9vDsedzliY08j74yV1Pu86aqLbXY5zsai1OM32pJ00mvE55q6IbRvxCK1NS1/l7o1uVRvyMpzbe6TNLn6EX0u72RTVnv9Ce8Xoad/oYe8fl+o+gt+m3ufk0a3NI1TyN1/iY7vQrGFfXG2xm3ZZSfkaE2uzMXkdc9iauBfFIhuWVsw3vzf3NPvEnwybn3sl+j2wvikOhSb8X9zOOSS7P/ABOaMn4s3QlXgRXrrwtms/Drhz3ZF0/qHtB1DB7PdLxTnm1LuTj/AAQvlv6X9jT7yVxhjxznOclGMYpttv5H7B+Hfsl/sPR/tmtjGfUNW1LI0lWNLhRT/Vm16LxZzcjevZ2PpTpduVn7teIfd+wns/pPZnpOn6To2nDBCnLalvklzJ14uz9E6e9uBUfJ9Mi1Xqj7DpyajFNUeqcXH9Or3PiYa4KRFfZ9DoFUIntaTsufE8nQK4I9rTKMIuc5qKim234LzNlWYiNyy7WisblOrdV03Q+manqmrdQwRtK63S8Ir1bPxrFqdR1TVZ+paqbll1WR5Jel+C9D0/bL2ln7U9VWm0OSb6foptQl2WXJ4y+Xkc2j08riv1PFvWHXZ6pyv5fDO8dP9Zcfz+ZPMzapP2w3Y8UsUEpRpvk9jR4Zcbvh3JJfTn+hy4sUZ5Fu8P0R39PlDFJzyq1CMq/5n/TxNBxMcTaNo6U7Xo6RYFsx5cquKlNzjOqbb29/uzvhPG9Pmk725JvZNVz8r7rt8zztB0panTPLKTissVjXCfxW77nqR0cdHFYZzjkxu5Y5rxt0+/iq8uzZ1fGpkjHF5r4lkV20T/PBTlBLDhcpc8Unwr+fJo1+XK44lD4ljhTyRu5RadJX4ed8016G2LwajVxhOTSyY5Yri2knx4+Xqa+oSWOOT3u1ahqEZbFxtp8/P/Arl84plJWHiahRgk4rmKS+hzzlbTo3ZlcUznfZHPXndklVyS/d1XiaI/nRsyS+HsaJ/wC9RHMqW8w+29h87hr8MU+dyi/qfruGTkuT8T9kMkYa/A5T5jkh9eUftenqULTPYfRF+7gzH6t90Sf6Uw7IO1ZtXBz4nxuN8eTtG9hmAAqGZgZgAAAAAAAiVAUAAAAAI3RQAAAAAAAAAA78Lv5AAAAAAAAAAAAA58AADcn3dgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAETsoAAAAAAAAAjVlAAAAAAAAAAAAAAAMWqIZmAGLRz5oXF+p1GEo34geJrtPcd1HyXtH0HT9W0WXRazDHJiypppo++1OFSxvg8XW6Vyi0iy9IyVmto3EoMuKuSs0tG4l/IX4mfhvq+hZ8msxwyZtI7aytW4vyn5f8x+R6/TTxyluXc/uL2g6Vj1CnHLjUo8ppq0z8G9u/wwjPJl1XSsShL4l7ntGXrHyfp2PJvUvpDJjtPK4Ebj5r/08W9U+gd3nl9N8fmv/T+fs2JxlTOLK2kk49lXc+i6z0bWdOzSx6nDOO1uL3Rp/Y8bLjV8nD479s9to1MPK8kZMFvpZo1MPMyJ7b8mc85U6o9HLg3XKL7nHkg4ypmVjW6c0slEnO64NkoXXJraaJdbV7Ry+FR8rMd3oNq8Q1xSTfyHZK7tRuzFu01Rk4yT5i1fmY7IqPKui6IXzHa1qLRmrUaofGv4OH6oi3/xPjwRS8zrRETPsyg9y8jYnJyjixQlky5HUIRTbkzZo9Ln1eeOnwY1JvvKX5Yr1Z9l7Oez2n6ZLfjbyaqX583CaX8sfJGTwuDflW3MeIdL0HoOfqOTutGqfl2exXso9FqIa/Xx3611sVKsPyfi/wCh+qdK02R5FCvh8Jefr/mfP9F0EoNTknKPG2vE+16Rpcnwuqddl2R3XT+FXDERWHsvTOmYeFjjHjjUPc6PpXti5RtP+x9b07AnUnHg8npulS+JR4lwvkfUaPCscFa8jpMVdVb3xEeXqaHEmkkj4n289sv2t5PZro8rxp7dXlT71/Av1sntr7ay0il0LoeRftk045cqf+5i/Xwb5Pl+ndPWLGnJW+7b8X4s889Y+qPp1np/Bn7p/tTH+zl+qdTnNb+XwT+8/wDDo0emjixKMY1aPRxq5Y4xbqKqiaVe5kpuN+XoztxRlJPbBd74XY8543G7v3YeDF218M8OPffxVXoehpcfvHOKe1yjtUn2jfia9PijKXusUZOS/NNpJ/S+x6uj24dNHbkjHLJVjlJUoptW22vFf0N/weF90b9mTEO7RQxLJtiqapxS5ppcv1SfD+fgbcznijlzTamlFSjNrhd+32a8vU4tu6dTfvGq57Kd8NL9DfqJLNGWGUahGalN2n8MU7/twdLW39L6ce6T40x0kU61n8apwxviLj2fzf28DzdbOGTNmTk1Cfw1X8UfGvBWv1PU1LcNNqNE3B8QjGT+FU1zfkqXf0aPJ1eWCyZ4xyKabStVz5v6/wBjC526Y4orEbeZnk41/L4nNJblwzozySionPKW3wOatO5SRGmrJJ889vA1ydyUvUznkXajS3bXHiWb2pb2fSezMo/tMOf4o+Hqj9v0c1LGlfgfh/su71uD/wDkj/U/aNLL9328Eev+iI/9Hb92+6LGscvVxfl+puic2CT2Kzpidw3sNgACoZkiUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAm70G31KABGrCVFAEasoAAAAARKgKAAI1YSooAAAAARugKCJ2UAAAAAAjdFAAAAAAAAAAEaspEqAoAAAAAAABGrKAMAZmLVAa5xtUcOo099keia5wsD5Hq2g95uaXc+F670dz3KUXtfgfrOq0bk3StM+d6p0tZE04kV69zGyY4t5fzp7W+yGg6lDJHPh5j+WS/NF/M/Gev+w+p0+dw07WRu6qlz620vsf1p1/2fvc4w5+R+ae0ns0nubx032dHI9Z9N8XqU92u28fMf8uR656V4XWo/q11b8x7v5p1PTdZpMrxajDKEvBNNNr0vuefm0uSUnar0fDP1z2i9ntS8ck+Mf8ALVr7P+x+fdS6Zm0u7DBbK7Rq4v7nFZ/SvNwf3cxb/R5nzv4d87BueLeLR+J8PmsunlHhxMJY9yptv5s9PUZtRGUp5MGCflti4/0dHm59c4W5aBr5ZO/6GBPSefSdWxy5rJ6Z6xinU4Z/wc88bjw1RK+Fx8zF9TjNPboZf+pf4GqXUpt0tG153L/IrHTeX/8AnKynp7qszr6Mt8ocJNWYLG2u1mh6nV5Y7Y4oQvxjHn+pvjgz5o/HllLb4XS+yMrH0PlX9402/F9FdS5Mx9TVYWMI70pTS/V/ZHRpumPVtb3KMX4dm/mbtH0+8V7UfRdO6faj8K7G74fQcdPuyeZdx0j0TxeF9+b77f6NnSulwh8G2KjjXwJLsz6zpHT4ZJOdUm14ehq6V0nNOdSSXY+y6T0lNJKKSXob3Dw60+2sO1w8OmGNVjUQ6elaK4JVxwkfY9K0NtS2umc/SulxpOapeHHc+m0mLHpMMpz2xhFbpSk0lFebs2ePBGON29mTa9ccbl26LAscYza5j2PD9qfbSWmnLpHQ5qeplxmyrlYYv+9fY8Lrvtvm6nkl0f2Zk1jT25tWu7Xisf8A/wBHJ0/pmLS4kkrm+ZSfLb87PPfU3rGMcW4XTp3Pzb/py/P6vbNacPHn95XQ6FQS4c8s3unOXLbPaw4skYRjtuvIx0mBOCUI8s9TBpVGFSbUuKknSXNcnnWDDfJbvt7/AKsPj4OyF0OFrJGealGKfFPk9LBgUscseKTaXnXddq/wNWLDv25PduVeEVyd2HApp4tyjuptt0joeLimNREeGfSuo0w2S9y21UnHcovuehpcMc8YpyhWBPLPdKk07qPr/bg15prJKO1RjDFVpKqfovXg2vPlWkjpcUYRjqXuyzUX4Nqk/E3WClMVp7vbSSK7ZYJynknqJXv/ADbUrcYqP+b+x0vJhzZc7yP93k/dp+Kl/D96/U07Z4cGTEsmNSglPLFx5ku6X0RrzahXHNOKWPPB1Bv+LspV4E8TGCIm3urEag1epkoP3kVveJRmqtY27/La7+ngeI72qPC78pVZvz6iaU9MpcXUn/M6pf69DzZS4vyNJz+V9W/2qsZZPeSk/J0aG6iyuSlNvtZrlKqSNVafC5rnL4exqb5MpO+DFdyyvmVt58PqPZVbtdp4+eWJ+w6GW7Gvkj8l9jMc5dQwOK/Jcn8qP1rQfkPavR1Ozg7/ADLoukV1imXrYuVFM7I9qOHTNur8zuiddM6bqGwAFVWSVFAAAAAAAAAAAACbfUoAAAAAAAAAAAAAAAAAAAAAABNvqUm31KAAAAAAAAAAAAAAAAAAAAAAAAAAAAidlAAAAAAAInZQBEqKAAAAAAAAAAAAAAACJ2UAACNWBQAAAAAAAAAAAAAAAYAyasxAwnC0cOq0iyRbSPRMJQVU/EpMbUmNvjeqdLjkjJOJ8L13oMpxlUVx6H69q9GskXJL5o+b6n0xST+EivXujSO1X8/9c6Am5R2cPuqPz/rvs3FuTcbb9D+ierdBSk5Siql24Phut9CUpbY407vwRiWwxMalj2pE+7+fNf7M05OMO54Or9nJx3NR/Q/ceo+zbV1j/Q8PV+zck09q5vwMW3HqxcmGk+78XyezkvJf+kw/+XcsuyT+h+r5vZtRde7ND9mUv4CGcNYRzx6fEPzKHs5lVfAvsd+k9nciqe1fKj9Eh7ORjdYkdOD2dqW3YuSyceiuGtXxmh6HFbYwxPzlx4n0fTehpZHtw1aXgfSaboTSqMEnH0s93R9DUZ3Oq9eSsY/kma0eL07ori23FJfI+p6b01Y4xbiq/qYZtR0zpONZddq8WG1ai38T9Eu542b2t6v1BPT9B070uKfD1GeNya/4Y9l83Zp+o+oen9Ijea8Tb8R5lq+R1XDxt+dy+r1/WeldAwRzdQyVOSvFhxrdkyfKPl6vg+Q6p1frPtZtjmb02gT+HAne7/mf8Xy7F6f0PF+0PVayTz6iT3TyZG22/mz3tLo1kmlHGlFeSPM+s+qub1neHD9mP8fM/u5rk8zkc+fP21/Di6Z03DpcajCEVZ62LTZckYvDDdffyMtLp98ba2R3q1d7q8vuetgjB4v3UNkYtrav6mq4vAjW7SkwcaKxuWGLT51l3Ymqvapvvz/Y7oLBiwTyLdKcvhUnS/twa9PHK+dkatpqXJ2Qwe83Y4wjJ8VGu5s60jt7aR5Zuo+Gzp2TNhyQePGmpXG34prujpxY1ljijJwx+7clJ+Ft9/m+xqji1WGEcSwzio/C+Oa9GbsWKOSWzBFyk/BUZ/Hi1Iill8S25ZLIpbcShc+NvZu0qQzS26RpRinhlSklT8eSywzlkhpVUcmOLcZN2rfiSU4SeVPJH4oSi/JyVLhfQzrRO5mflexvBCco5ZfuuZRyd23XMW/HlfqcmbLGfvoTk1On7p3zHs2k/obJzx5cWTLkzKDwK446/ovoeflzSlF5HzOLTX9zB5WSYiJGGeSUHNuqr6s5Mt7bvsbM024pPtH9eTky5Xwq9TTZLLojSOTctxonOlZk534GqUvAhmV3sm70GN3JKu7o1ykrtvuZ4fzoU3No0gtO33nsNirUvLfEIbX9f+h+n6LiFM/O/YbBFYZZnDnJJc/JUfoul4bR716ewfQ4FI/R1vTKzXBG3p6f4Vb8zvg7VnDiVqjtx/lN9M6bKG0ykYmUSqqgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAm4t2AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGAAy3ehG7IAAAABqwG6A1ZfyP5Hm6rDGTaaPSyflOPPKKhyykrZh8n1PQRyKUWrSv6Hy/UulY5JqeO0fea3Y5vb4rk+a6jm00G/e5YY4/wA05JL9WYmXLTHG7TEMbLkrSN2l8HrujQbe2PHqeLqOj1JuULSPq9f1voGLcsnWNGpR7pZFJ/pZ4eu9rPZvCn/2nNmfh7nBJ39Wkabkda6fg39TNWP8YazN1HjY583j/N85k6RFyv3fc0T6bjTr3S+x26z2z6fH49L0fWZb8ZqMF/Vni6j2t6vO1o+i6XEl2eXLKf8ASjSZ/WPR8Mf3u5/SJlrsvXeLTxWduuHSsf8A4a+x0S6Xg02J5tVLFghHvLJNRX3Z87n6p7Wa1OEuoLTwl+ZabEsbf/mdv9TlXQlqJ+/1mfLnyPlvLNzbf1NByf4g8Wvjj45t+/hrsnX5tOsVJ/xern9qPZ/Q7no3k6jkXCjgg3H6zfH9Tys3tB7RdUcsWGWPp2CXaOJXk+sj0MHR8MEkoRVduDrwdOrJFJxrnw9DkOo+rOq9R/p1+ys/hrMvK5PLn7p1+zxdJ0RSk9RlcsuST5lN3Z9BoumyjD4IriN/I7seh9xKHvIJeUl4HR7hJ3F/A04uk6b+foaSvFtee/L5lTHxo97OfDo3LHFwhubai/SXkd8dBHHnjiWadvGk4rs+a7+nJ6OlwYsEd0Wo5MclUXbTkuG36+nyM/dZpt5HzufHmjdY+LjxV/WWbTFWI0YunaeKhvc6ir3J1FX4I3aaWBY82ZupQqMXH4e7MYRyZNU8GNRjB1wr4+7O6eLC5bKUZKaUVFJJ/Rc9jPxY4vHdSNaXxVhjxQTSauU/4X2T8b+aZ2aeEcccbxqXvZTSimu/LTr5Fw6bLmcmoxi4q05c064VepnKEvdw91LHBxhubcrd+ro2HGwWie6YSa03TU45sja3QWzHPuue1f5mmGHHt088bqLclJ/ypdn+j5M8kcmOMVm/d457cjl4OSfL9PH7G7UTjhnCckoLGpKG1JKMlTvjwqzYxjrNpm/wu7WjXqa3qUdqmoSjTVxdv4b/AF9K9Tl1GSOfSaN5cf7zTy921d7l3XH9fQ25NZOLx5FOEYSW5Y/zJSuX2736HnZss5e738tfC1xwraV/RIw+dyK7ns+VdMdRkbcs2WEb2rlL4X518v7nFmnGck4+R0anUV73Hj+KKn8D8vP+x5+SbSpNJ+Jz/Iybt4V9zLNLhHJKRcmRq3dmqWS6MWbRK+J0jlx2NUpDJl2pujTLKnFp+JFMrbSsrbXNHXpviyeRwY25SSiuT2+l6VSz4cU06ySp/Jcv+n6mf0rjzyuTWkLKUm99Q/R/ZHBPHpMMZcqMFz8+f7n22lg6vzPlOhxcccF5n1uk/Ie/8SkY8MUj4drx6RSkRD09N/c7IdjiwJpJnbDsZjIidtgACrMETsoAAACNWUACN0UAAAAAAAAAAAAAAAAAAAAAAAAAAAAXDsPmTl5gAAAAAAAAAAAAAAAAAARuigRug1ZQAAAAAAARqygAAALJVXqrIAJt9SgAAAAInZQAAAAAAAAAAAAAAROygAAAABE7KABgAMyJUYmYGAAAAHB1LrvS+mQvV6qEPS02/oR5MtMUd151C2960jdpd5JS2+B8R1P8Rljk4dN0cptfxSt/oj5bqXtT1/qLcc2qeOD5pP8AwNHyvUHGwf3f3T//AHy1ubquHH/Z8v1TV9a6ZoFer1ePG/Ldb+x851H8Sug6Pc4SlkUfOKV/dn5lLLkyRyPPqW+aik/1OR6LGnccKj6tnMcv1dydf0oiP9Woy9az2/u40+z6h+LrqUenaJN+Th2/U+b1/wCJPtHrKjictP5tRjG/ryec9OoqSUYq+9I0vT464XJy3N9RdQzePqzH7eGsy83mZfe7VrOtde12Tfn6nqJR/leaSX6M8jPo5T+OcVN+tv8Aqex+zc/CYywbPU53kWz8mN5LTP8Aiwb4b5P7cy8JaFr8uOjXLp0pcyjf0PdeKLfYx91w9prv/HRb3QTw4iXz8unutmxUR9NTX5Ee+sPL3x7qka46WeROMJLd5Pi+WX16dWJ1pJHFj8PGh0+Mf+7NkNJGLtY/uevHSy21viqTb/wMsenjDA4OHxPakk+Wm2nRlU4VafCWuCIcMOnSlJRli2Xz8XHHmb46fF/vNv5UnVPmztnH95LJkx1vqlfCpehsen7VK6afYlnBSs6hN2Q4JYHOTcOLd14I79Pp3irZOVqVONVafdr/ABvxM/dRhCM4KpN38q/6nT+zwUIwyyjujblJvjl8V5k+DBMTMzC7ta9P06M8rSj8Cdt3w78L8zphhhlyy3Sdyk4unVWr/wAiRySxcQqvJqzthjxYHkz6xr3zb2p9lx3f9l6mx4fHpk/w919Y/Lmwwy4YTipRSnk/NLu42+fkk0Z4tNjeSUca3ut035rxpebNs5e/91iyrdGC2fJLw+S8fUzxwjsclOnJNRdNO0+ab+hkYePE31X2U0NxzZ9uZyVNOLrjavLzNtLJk3z2zcU3FJ+F9rXfuTVwitXkzPLjljjH3Un4J3wvn5/Q0KSxtrHHY3GnFPhc0jKtb6W6rtNsdVUYQl+8coSaU3dRdKKf37f6XLKGOOeekn+XakpU7UXy0vtRXlhh3QxaeG2WVTxSlzsfZ/0fz+pyTyOeVZozVxbVdrXg6MfkcrUVmZ8wuiDPm3Sk8rSlBK4NJq/Pjx7X8jlz5HHalxLncvXzDag5TfKvj1OTLNzfLZpuTmnJPhfPhJZPhb8b+5zTk+77sspUaJzvsYUyp7sck7lRpyTpWvAS72ac0rVUQzKkys5r7+pzzYnTq0a38VIi3tFNnTpf94fV+zmlefVrIufdpxl/zOrPldFBbpTbpRVn6F7KaP3WDc225cu13Z33o3gzlyznn4bDpmH6uTu/D7TpMHFK4pWfRaX8v1PE6bCTjHjse9pcbSXqeu4Y+2HV0jUPRwfkOldjnw8xXodC7EqVtiUkSgZRKYGSdgUAAAAAI1ZQAAAAAACNWUiVAUiVFAAEasoAAAAAAAAAAAAAAAAAAAROygAAAAI3RQAAAAAAACJ2BQRuigAAAAAAAARqygAAAAAAAAAAAAAAAAAACNWBQAAAAAAAACN0AkJGIAAAAAef1brnT+j4veavL8TVxhF3KX0I8uWmGvfknULb3rSN2l6B4/V/arpPSIyWTL7zKv8Au4tX9z4jrntxr+pt4tDJ6fDW2l3aPmpznkk5ZJuTfizkuoepq1+zjR/i03J6rFftw/5vpere2/V+oSli08lp8PlDv9zwJTyZpOeXI25JpvxMYtctMzi4K3KVfTlnJ8rqOXkW77220uXNkyTu8sYYsWNJOcp+XHBjlm3Jxiq2q2wrnz2Sd2ZzcYwcocytNvyrua2c9r+/si1v3c01GE0ssGp1ai+OKv6GGVT903t/M/p5f3M8jxqbTmnKlFpeD+fjwa822dygtihSpSvi+/z7fYw7a8xCk1jbTmhGMUlNylH81vg1e7hFL4XfqjoluXHu/jvcnYWPJOEnSXa23yY84/uU05Jp8cJc9kjGWnnOVxjbPQlDHzGKb2q02qtmhxyzm9rr4W6X0/xH0/ypNXNLFixqoq2+/wA/Iwlig1SVX4+p1OGPbOahPlXb7Jf4mueFxjvtOCatr+G+U2Jhb2tE8VqppX4VyYe6i6cFUqpHS4xUmkmpd903w/Uyhix592LTOL2q5S7blXaK8/8AMrFO6dQTDm9zkztRUVGFN232X81G/Jo6wxnLu2lGUFSteRtljy5P306Spdl4Lw+Vcm2enU5uUsslkbU/d3fHh/0JvoeP1VmsaaVpnGOSG662815+H6sr0yep/Zse3hW5N8Pt+vN/Y24J5YyhLDFPI1ujfg/P/XJulH8sLpRfxvzblW7+nd+TJ/pY7U3EGtRtreH3k5VByipKEXBbeKXe/v8AIk4v9phocOFPNFbZtceCav73fyOjQOOPNKePLclNyTk38Eady8b+vbk06fJPHLPvxyjmc3c5WqhdtefhXqZFcVe2N+0qb1AsuPROKyzUpyUrcbTrtav1/uyN5MsG6lNubbmlzafmMmNZM95JpTaTuMeL8kvF9iRzX71PNCMMSUYwqoyfG1frZWNT9ntX4V3tv2xxaZamWP459opbtz8u/H/QyxzeZKWeW3FjaVR43NNpL5fLzZzueTLq8EsuTdDa5duLT+3f+nlwTU6yODI1jacpc06pNLlqu3j9yaMtMVZtPiI/1Xwy1GrwxlKMFJrI7pPiLpJtU+OV4+HzMMmeShKCjJvi0v4uf0q/r4nJkzrFhUFjjTVxbXZNvi/N9zVk1Ecc4ywprJG1J+tf65NVn5W9zM+6kOzLqsuNT0spRk4wUJNO7d3+nJwLKsf7yS7OqXHPgzU8qW5y8O7OfJmTUa545Nblz2vba6PE7ZZMjfd922c85tEeSq4NOSa8uxjWsE8iqjnm33Eppcmmc41SIplSZJ5HLHLvwaHOk2Sc200nRq3UQ2tHshtZm5S8GWCt/M0r4/Q6sCcW5tcIripN7xWPeUcT3Tp36HCsmfFhhym7k/XyP07omn9zhhBrxPhvZzRTk45MsLm3b9PQ/RumwShCL5o9z9PcGODxa0+fl1vTsP0ccRL3dEvhT8mezpYPh+SPL0UEocHs6f8AIvkdXT2bWIdeFpLadMTmxr4r9DpiXL2xOjIxMgAAAzAAAjdFAAAAAPmHt8HYAAAAAAAAAAAAAAAAAAAAAAAAEbooAAEasoAAAAAAAAAAAAAAAAAAAAAAAAAETsoAAAAAAKtv8TogAAAAAAAAAAAAARugKAAAAAAwAAAAAAAJOcccXObqK7s0a7X6bpunlqdXkUMcU22z8x9p/bfP1dvS9OcsWl4t9pTa8/Q1nP6ph4NdW82/DE5PMpx48+76P2l9vsOmU9H0pLLmXfIncY/L1Pgc+q1Guk9Rq80sk33bZywffi34vzNnl4Ukjz7qHVM3MtPfP+Hw53PyMnIn7p8LunSjBduX5mSW5X9zH8vKb3eBU7ltl2fdeD+ZpZtO/LFrDZGKeNtfxEi4JvzXF8muU2+G6S8EYb0lb4I7eVWz3kk6iuCqaT3yfg1X+vA1KTTbj2Zkkmt3YsrtSEnt3boxpvnns35ox3Oo7IxTVN3zbRY24NNfl+5qkpd4umQ9sxO4U3pt+LJJtyuVc13fyMWryx287la9UIRyXUX3VN+JlGEpO8y4XCa7pl0UmfMrWMMdZ4z3Nctrfwk/mYxls95KMr2N7q7SNjlUU4pOEk1yvu+fDsYS3QUtya2zvh9y62PthbJJZNsNkLlJST8u3kYzwy3Yo4pcuKcnOXd3fb5LsdWn2/s0nKcl5JPx9F/ruYShtnBZYNOrTXOxN9vV9/Qv+huImVHNlw4nOfvY70qSXa14K/BcMzwx7vDilTrl8Xx/mdOTFBb0m4qknKL4fFp/PuY/k3ZYKKSfMZJ7qviXHrX1J44s1nwQx0s4znc8a7Jt+G3wteP3MNG5PUTzONyW5ylfy/Q6Ns8Wi943FZJxcZpRXFrx+Xiuxjpt2PQZMj23kmsbuNtpf4/3Jq8eZvXHP7yv/DVjX7nHlyJrbCmk+Upcpy8u/PlwbZz3YMk9slJJRbd02/Dzfz7GeTNkUXOcVjju/wB3OPF/yt34rtf9jBzxYFm0qT3Y/wB1jk6bqTXL+X9yWMNaT2/Ckx4asEcUZbv2mUcTluxPFJ3JR7tR87ruM+WMsEtR7v45JTg1J8Nx7Lz/AC/Tt5knkjPHjUJ1mxJRxwS/LXl/wvl/oaZ6hzx6aKShCDaVpS+fD+f3MW9q4vsWfo36Xb7zG5pVFKpUn8Ul/wDd49+z+ZxvNumo7UvVulXa7+X+uDdk1GLTz+CWKfhjSXCfi2vB+F/M4smWMUsk0lJNvhU5W7v/AF9kY3LzxStYifZSYdep1uObUNMqjjuN7vBdqt0vp6Hn5JLcowe5pNv05/zMVnTuT4Xjz3Xkc3vXBy2y/MqZrs3KnL7rnRLNG3kU6dptP+J+Byyz75b52k2657mEpUkmaZ5E6XkYVrTb3Xa025MrXxL7M0yybnuuzCWQ1OaVkcyb02SmaMmTiXoRzs58mW0yO1ohbNolnPI1VM0Sk6sxc7NOTJtVoxb3nfhDN5iSeRo1uTavsYyyKXL4LB7qZTe2PNplsiqXzPR0uKefUrEnXu3c16+RwLLHEt8lyuIrzfge/wCz2hySkpSXxSVyfqdn6T6RPJzfzOSPtj/ds+m8WcmTvt7PrOi6aMcMVKNN8n2miwKKjaPn+m4o7Y/C/A+r0mFuMYvwPYePTUOupGnoaSPwLk9bB2R5+mh8K8D0sfHBsY9mRV1w7o3Q8DVi/MbSq5mZGJkAAAGYJEoAAiVAUAAAAALXwuXkQAAAAAInYFAAAAiVAUESooAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAI3QBqygAAAAAAAAAACN0BQAAAMAAAAAFoAed1vrmh6DpHq9ZkrwhBd5vyRj17ruj6Bo3q9VK2+IQT5m/JH5L1jq+s61rJazW5Lm+IwXaC8kaDq/WacGs0p5v/s13O51ePXtr7tntB7S9S6/nktRP3eCLqGOPZL19Ty4JKKj5X/Uk1dFTUe551yOVkzWm953Mucta2W3dafLJOjJSdNyaaRpeSVWuxjLNFx2rm+5izfZEab5Nt3a+hisqfD4Zgp0qS4RrbsjlVt3tLl2/Mz7wUPC7NcTOT2q6suiqm9qlfJsXEW6f0JGO6oPtLubY45JSjHni/1JYxb9lWqm7XyK8UlTktqurN0MKlLfJdk2vJceJnki4wai2nKklJ8tea+xJXDqu1kzuGKxShFuCah33SVV8/X+hrlByhfN7eyXdedG3Hjnklii5tJY2opu+PTzRg25SXvJ/DLxiqTaLr447drJnbW24zWCceWntad22u6NMnKOnnLYm5VbfhG3X1OpQlPDvkt2yPu0lx82kvDv9jXHGnhlKeKSgn8dPmKXayycfnS2WTxL8kOJ4/hi+98dv17GrP7+GTZvjxxCK5VLzMsmpyTyP9mmsfNqTVc+r+XgYZMscmRZYu8kZXH1pUmW5Jx68SW9nVkeOOLKsUZLZHc3VPt/rl9jTp8kp455W4r3cYxhCMeL73XjZzS1UpQlGSv3iWN33Xe748zX+0ZVHFOWNR4aTXeb7C/OpW0TCkTpuk3lxS1O1RUJfkiuIp939LkE4qCnp4TxT21TfemrTXa+fT5GucoOFxio48clcLu/Bv7+BhklLDCU4qDxZKe2cbpJ8Nr6EcXmJ7p+T2bM05rDOc25x4WRNt2nXKvs1ZZar3c55NOkt6cWnFO/KXPg06OTJmnu4UfiSc4PmN9/8Ga5Z5ynKSlBOceKVqq8H9CG/K14hTctss82lllFJRfZfl8mq71z5mic1KMUk1KDabfK5tt+vdGn3j7KXFdvL0Isi2OFdn3v+hr8mW1/Mkxtty5YNzcU0q4vv8zn1GXJNw42x8u/H1MJZG4teLfc05cjlFJ3wqMTJkmRk5Lzs1SzNy4ivoa96SpujXLI4rir865Ie7Y2yy0uxonPjnsa55FfxPk15JpIstaIGTy3wjU8l+BrlNPm7ZrlkS7EM5YUm2mTyU2muxqy5FXfgwnkaTbdmic4uCknyY9r7QWya8M5ZP5ZGmU2+5i5LzInykWb34QzMz7szdig4q348/JeLNUFuvjsJz/adT+yYJ8QlWWS/if8qfl5m36V0zL1DPGOsfum42G2e3bV29P076hq4ThFrFbcE/Fef9T9B6PpIxjGLVOj57oHT0oqTgueEfcdM0nOP4W+T2vp/BrxMNceOPEOv4vHjDTth6vTdP8ACvgR9FpIOMUzzdHiajH4aPa0+NqKRv8AFGqthXw7NJjdWzvxQ8Wc2GLjBWd0FwjITQ2Q/MbYmEVTRsSoCmRiZAAABmAAAAAAAAAAAAAAAAAAAAAAAAAFxJSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABG6ASMQAABQBwda6xo+h6Geu1cvhjxCN8yl4JHTrNXg0OmyarUZIwhji5ScnVJd38j8e9pOvZ+v656mcpRwY7jp8btNR7b2vN/ouDSda6tTpuLVfN59mBzebHFr495aus9X1XW9ZLW653LtjhfGOP+LPOlKib274NUncZM8x5PJtltN7zuZcvbJa9ptadzLbCSST458zVPI5SfhTojk21XgqNTfma++aZjRMzDOLk+zpeJE7NadBOiyuQiW5Noyx+Jrgt3Zm+K3SUTJrO/K+ZVujYuePqY7Yrck0nB07NuOMsmTGlKMOGn9PEyKwpEtkGl4dje5xwYllk07aaSbtPw4+pMGLh/HFfzX/L4v+hhOSWnyZseKKUWpqLgv3itq/0oza17KzZSJbIylGMpRa8OyT/9JhNxlGc9NDdJyUU7ddu6NcdTpo73OWPdBXF3cW35L1V/YxWouScMcd0otwjL4ounTfrf6EMZ6xX7pWTO27JmyKPvM2OoJpOUFyufDz7f0OfNmlkzSljmo4kq5XKfPZeJzZNVkVxXCh2Xgvl5E9/kxwjPHxudNSj/AEMS/NrM9tfZZM7dOXLkeFZIyhtlUUrXEfH1bOeep3xfufy0k5Pm36L+nkc6zQWRtb5yim5fyt15eRgs0pX4wu4q1RjZOX3VInTdPKpqKm1GKVRXgYe9qLlJpSj+VpdjUorI1KWSMapu/Bc0vnwap5JKTcXS8EzDnLOtybdWbLOLXPxSSdeK8vqao5W4qM5fkdvtxz258DneVue+Ttvu/MZJwk47Unbttlk5IvbcExp0ftcI5XB4lbmpJO1Hj0vzMJ5tu5zk5OVL4nf+kc2TNByjbfDrdXb1MfeOV3y48F31rRGtqOieeTxpKt0nVJL7mqU258vdtjtj/iaXkp3dOjVLI+b5LLXXa02PK2qS+ZisrSqjRKTbNTyyU3fJDa2yI03vI1W5Vz5mrJl3KjTLLVfC3z4GqeW3wiC0rW2c15mqeRxlulLhmuc1KNco0yyLhXdEO9DZLJG3K7MJ5lJGmU3ba8TVPJS8iy9p0stb8tk8sb7ml5It/m7GueR9mjS8u21X5uDFtbcoL3/DbPLb7WjVLJXCianlauEe5dzclFcFvuh7l3ehnHjk17X/ADfoadX1GWkktPpVGepm1w/yxXr6+hsOBwcvMyxjxx5XYcNs1u2rbqc+THl/ZdOry/xtfwL/ABqj2uh9MxxjGe1+vqeX0TpUn8U4t7ncm+8mfedG0GxcYz2LonSadPxRWP7XzLruFxYwU18vW6ZolcajwuD6rp+mktu1djz+m6VJRVcn0Wjw7UmvE6nFjnWm1pDu0eJ0m/A9XBjbXZnJpcUlS8z08cGzNpGo0miG7FG6Xc64R47mvFD4U7N0OxcuZw7mw1pUbErAyAAAAyiBQAAJu9CgAAAAAAAAAAAAAAAAAAAI3RefAjdFANyfd2AAABGrAoAAAAAAAABGrAoAAAAAOfAAA3J93YAAAAAAAAAAAACN0UAAuXQfEnHyAAAAAAAAAAAAAAAAAAAAASRTAAAABJTjHu+5JI+a9tPaBdJ6e8OCVarURccb8Ix8ZfTj60Y/K5NOJinLf2hFnyRhpN5+HzPt77RvqGsfStJlf7Np5fvnHtPIv4b8lw/n8j4/K9zVyMpzXLbOWU7PIuo8+eXmtlt8uO5GeeReb2ZPI05Klx2NW+4bpSMZStNGn3irk0uTNv3RV18uieXb2V2rNTnfKNfvUyKdXa4ZjWvuRm787Nt+fK8jVCe2od2HNqT2sd8Qp3adEVUd8VV+DNinfK5n/mc8I55RtPv3+RuxzePJe2LVO7/qZtJmff2XbdeP8zhNxU2lKPk/mbN8k97745d/BeaOH38OMk5pt9mn2bRnizN/vJuEklcoLmn/ADU/634GVXPWI7VvdLp/aVmWbBPZjhLhK3V8d/sI59PGbllmobV8WOXMY/T5f65OBZZZce2XhJf6+XqYznB8znjjFNq7vkhvzbfB3T8Niy4ozyX+RJ8qNySfajVKWSUYSU9qrYlxx+pqepwLFKOR3zw35J93/gc2TUSyPdkds1+TL+pLtnmx48nKlxL52kqNc88HuaSTcuElVLy/6nHPO3KMdr58iPJDzIfrT7KOl6hq4x4bJHUywxksNJyX5q+JLyXkcry+hN6UXJuizvkbnPs38XKk13+5h71zbb7HM86Sex9+5j71RTjv5fd90W2sOieXbFteAlmnC8fHhz/U5J5bjtfiYZcqnK91lIvoidN7zbuVxtl5mKz12jXy7HL7yqQeWiv1JVidOj3smvi7mueZydeRzvPLwNeTM4vzFrbJb5ZPmYSy14Wczy7vHsapZUly2RWvpR0yztdmapZk35nO8kn3NDyz8yG19xpZN9OqeS48OjVLLfY55Zr7ox978yGb9sI5yRDc8jNUpyfdmmWb4nGnwaZZvJP7kU5NxpjWyN2TJS5NHvb8P1Nc5Ob7k7qkRe6ObtpvSvk1wjaXr4Hma3qssk3penzt9p5V4PxS/wATddM6Zl5+SK44S8fBbkW7auvWdRjilLS6dqWdd65UbNnSulylL3uT4pvltmnpHTpOpSjd889z7bpfTNtfBZ6x0jo+LgU1WPPzLreHw64axDp6V01KqguD6/p+i91FOu77HP07pyx7bSZ9JpNHbi2jpsOLXltKV06dDpqS4Pb0uOl2OfR6Z1VHr6fT8eRsKxpPEabdNBfCehCHNUasONR5o6cUW3ZLC+I03JUqNkFSMYRtm1KwqyMjEyAAAAZgAAAAAAAAAAAAAAAAARKigt/C4+YEAAAAAARqygAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABEqKAAAAAAAAAAAAAAAAAAMDMwAAB8gc+v1eLR4J6nM6hji5SfyPxz2h6vk6prcmrn/G6jFdoRXZf4n234h9ZjptLj0OKfOT45/Jdl9z8slnTe5s4H1X1Cdxx6z4j3c11fkTa/0qz7MpTk5VfDNcp0zCWVKjTObk68KtnneTN2w06zyz3rniRqlJ90+xg5OUmzBz28swbZYtA2Obabb7GXvY7YpeHiaNxjJ32I+7Y6Xmg3JW034meNeN9zj57xlX0NmGU5S2wfKVit/PlSZ0655eIxkrinbXmZY9RFXkkq2qqfZ2cmXL2SxxcvJl96pRlFRdcbUldO7Mr68x7Sq6sU4uXwu5r+Ei1M7ybuXjbco+a8mcTyd21zbTZhl1GP3e25SyNq3dohnPPwRLsnm95vybYR2utt0voaHm3q9tfU5JTquO6sxllarbwRTeZ91ZnbpnNPsYSyeqOeWdpXXKNc89yukr8inctdXvm18Ph3+Rr/aGpOUUufNHN75tVVGLyV4Cbqbb5ZpOW7d9PAksrceX2OdzvzMPfJeZZNpk23PJfgYSnLinRzyzW65VGM81xvngpuTbollaS5MJZmo8HLLLdbXx4mMstqk6G5JnbpeWRjLOqty7HM87TpyNXv8Avb7u0Jya9zudkczSdtcu1yacua0rRz+/4bb8DVLNf5nZZOWFs3iXS86Ncslmh5OLXZeBq99fHYx8mbyjtkdcsro58mRrsaZ5quNfWzTLLuXPBD9VDbK3e+8jB5pNVI0OXPDJu85Fs2mY0gvfw3qV3uZqb5MLfmZd+F3KVpN51CHe2UeS5tRpdJieXVZ440u195PySPK6j7Q6bQuWDSbdTnfFfwx9W/7I8/Dj1evzLUazJLJN8c9kvJLwOz6N6WzcuYyZvtq23C6Xk5GrX8Q7tT1DU9Wl7nEnhweME/in5OTX9D0+ldJUmqjaikvsZ9M6T+Xg+u6V0tQx7lFcM9M4XTsXBpFMVdQ6nBxceCvbSF6R0zjmFdj67pfTopJyffwo19N6dtS+Hln0mi0UYJScUbnHhne2fWum3Q6OKrhnu6XDUbow0ulSS4PU0+n4u6ozsdO2E0Q2afDtj3s9DDj8TXp8PLqP6nbiglxRN7LojbZhjf1OpKkYY4UrN0UXLmUI+psMIGzb6gUAACpWQySoCgAAAAAFPvQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIlRQAAAAAAAAAAAAwAAAwzZY4YOcuyVmZ857b9W/wBl9IyZF3neNc88939FZDyM0YMc5Le0Is2SMVJtL819r+rrqfVM2WH5Lajz/Cm0l/rzPm5T4rzZtz5nlk2c+WWxI8V6ry55Wa2S0uIy5Jy3m0k8i3Np3XBzvL4NBy4kl3kczy22pvt2ObyZNo27fXgYSnuVVRhGXG3wNUskvFmN3K7bm6dphS3cy4S7mje+4U5KSnLmi6ttq9zdKaj4FhK2oprn1OXJNjcVidStdWTLKMqX1ZcGo2T9432XbzZxSm0+7fjbMPfp8Kkl5CLzKsTp1S1DcpSk/wAzuuKRqWRXyaJZYy7GrJnTray3uW7dOXPPdwzV7zJ/N+hoeS+6MXlaVRZSL7O50OclG5Sswln5VdjneR8ts1+8dWVm2zbq98lJyb7muWWXg2c7zRMZZo1yWbUmduj3jMZZGlaZzPLUXJeBrnnutr48SndC3u06nl4u/GjXOb4Skck8tq14GHv77ls5NwtnJ+HXLMrryNbzx7brOeWWK7vuaZZt1bHynZFOSVn1e33djyM1Sna5OR6hy5fBHltVbI5y+Fk5m+eZLjuYS1HHCo55z+FswlkjVWQzk2jtlbnmkn+YxlkS8zQ25KuxjGb5T8qKTaUNsza8qXmN7aowSsON8WXUjc6W98y2Rbswd2zj6h1np/SobtXnSk1axx5m/kv8aPn9X7SdS1zWPQL9kwtVwk5v6+H0Oi6Z0DldQncV1X8yzOPwcvJ8xGofT67qOh6cq1OoXvGrhjim5SXy8F6uj57W9Z6j1drHiX7LgarbB/FJesvL0VHJpenZMkHObcpPu5M+i6X0hyq1X0PROl+muNwdXtHdZ0fD6VixRFreZcOg6RvgotV6n1nSujuNNq79Dq6d0t/D8KPqOl9Ldr4UzqqY9NxFWjpnS/y/CfU6HpiShFRuuLoy0HT/AMn7vzPodJpGsd7FH1MqmPc6TRVNBomlu932Pc0mkfwfu0XR6W4VuX2PVwYX+a+DPpTtjTIiFwaVx5bR3YcDq7ouLC6Vo68ONrmuCSIV0uHFtTtnRGFv5GePHxyjdGPqXriMfU2JUEqMkrARVs2EiUAAVKwMgABJCIkIgUc+AAC5/wAzHzBj4UBkCJUUACNWUAAAAAAidlAAAAAAAAAAiVFBE7AoAAAtfCpeZAAAAETsoAjdFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABGrAoAAjdFBGrAxAAElKj8t/FLqvvdTh6fGd+6Tm/nKv7J/c/Tc03CO5q/Q/Bva3qMdf1rU6lSbjKb2/Jcf2Ob9Ucv+W4U1/wDs1HWMv08MV/Ly1Pamzjnlcrl5GU5Xx4M05XCNJKr7njXIyaifLlmMsj4aNU53zRJ2uFdGDmvE1F8ncTKrI33JNxUW2zW+GYuRZ3KbbNy868kYSzTbrwMN6fjZhkl2oRbSkTpunOmqt8UYPLS5RzvJxcn2MPeryor3yt26HnTvh8GqWRNXVUalll4M1yyyXflF25VbnJrs/CzGU0+zOd5dzbrwNW+rLN/lbNnXOdIwjli3y6Od5nF8JOvM1TybpXF15lIv+VO+Kt7yyuSbv4nRhLLJeJzvMtziuWjX79P8zaI5vpZOSIdPvVdGM8lpNnL75tu/oYzz7oUWRk0jnLDplla7GqWSFOVnNLKm7Ts1TzKMW5X6FPqaUnLDrlniu/bxMJZtrqjjlqIyj5sjyyad+PYp9RFObUOmeW2rvk1SytSnS7I0KXnJmO5uTivuQzdBbNG233t9pfoV5ZeZrSjFcy58zBXK7fYt7pWfVhueW/B/cwb4MUu5NVqtLpILLq9TDDFKrk+/939CTHivmnVI3JWbZPEQzj7xvszKn2Un632S9WfM9Q9t8EHLD03TTyS8Ms/hj9F3f6Hzus6l1Lqkt2s1k5+KglUE/wDlXH3Op6d6S5fLmLZftq2nF6Tm5H9rw+z13tV0jRRcceeWqy3+TErS+cnweDrPanq3UnPHh26TE/CHM/8A1Pt9KPO0fTJNR3c/Q9rRdJlNU6p+h3fA9LcLiamY7p/V0PG6Rgw6mfMvO0/TZZprLJbpS5k27bZ7+j6NL4ZSpfQ9bQ9HnOUZRhfbwPpdD0iTcUoq0dPixRERFY1DaVxxWNVeP0/o9bduJI+l0PSXF+8lGKv0PT0HR+Y9j6LS9KqO2XBl1xJ6w8/pvStqVxXK8j6HQ9M+FcJfQ7dD09VHjse9pdDGMUq5MmmPa6K/Dh0ehjFxXB7Om0yjUFFPzfkbcOmx0tqtno6fTRjFNrkyaUiPKasaY6XT7U12PQw6e4J2vsMWFWl4LlnXCPHkTxCSDHhaSR14sbUU7McWNM6IR8LLiI0qg+1myMWRKmZrgKkYsy2sRKAAAGUikiUAAAAAAAAAAAAA58AFPvQLun/N+hAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACN0UAAAAAAAAAAAAAAjdFAAAAARqygCJ2UAAAAI3RG7DdkABugY5HUaA8v2j137D0nU6hL4o4pbef4q4P5/10pSzy3O6Z+yfiRqvc9AcE63zSfySbf9D8TnN3b5bPN/W3K/qVwuX63k3lin4Y5JKNcHNknuVUbM0vE5W7PLuXk8tNsnI1biZJ0+xqeSo3Rr9rZnSznO/h4MJZJeBqlNp8GDnbop3TCybxHu3yybVdGp5bdUa3JtOLZpnkSXHdcFIvMIpyRPs3zyKKto05crqm+5qlkk0k2a5z8PIrFzv37tsss12dGE8nG5Ns0ObumzX7z0E5dn1W6eWXhaMfeX5mqWSlbOd5Guzos79IbZG/3yTdJv6mEsytVZzuad0zUs0qUWyz6iO2bbpeV23HizGWRS5Zonk7WjXHKlfBb3rJybh0yn8zVLNfH3NMss33fBhuv1I5uinK2vKrpOjXJy/idowk+bRLe1Jt35FO6ZW/VZbkV5Eq4Mfh8EWMXJ0uX5eLLoibTqEVssz4hG2+5lF9zg1/WuldMi3rdZGMl/3cPjn9l/c+d1vtxqMkpw0GkWJS/jyy3P57VwvrZuOF0Hnc+f6dJ1+ZT8bgcjkamtfD7Gc4xi5zlGMY93JpL7s8TXe2XRNEnHT53rMqfKwr4V/wCZ/wBj4zXavWdSe/W6jJlk3dSl8K+S7Iafp0sm3JJL5HadO9EY6fdyrb/SHRcToETG81nr6v246vrpSxaNw0cJdnFbp/d/2PNeLNq8ksk8spzfLlJtv9Tt0nSryWoL7HtaHo+V8rEluOv4vR+NxK6xUiG84/Aw8eNUh4ek6ZKWS5NM9jRdGWSLl8vA+g0fs/lpZNq+R7+g9n1tlL3K5rxNpXF+GZFNPntB0PI9vwdj6Hp/R18Pf7H0Oi6NNbP3a8fE9zQdH+Dsu6MitNpYq8fQ9IhLI3KF9j3tB0hRSddn5Hqabpe17vd3Xkj2dH0yoqWxceBkY8UfC+K6cGj6d8LWzsexpOnXFRcO536fQyVZIwS9D1dPoKnuSUa/UyqYo+UtauPT6FRSuk/Dg79Ppa5lLn5HXj0cnylf0O7Hp2kldE9aRC6KubDp4qKaXLOvFp6pv6I6MWm8WkdUML3JuuC/2XROmnFgn/Kux0Y8dd4m+MK8F2Nu35FZnS5pUV4I2JJGShfkZpV4IqMaRlt9Rt9SgAAABUrLt9QKAAAAAAAAAAAAAAAAAAAAAAiVFAAiVFAAAAAAAAAAAACJURuwMgRqygAAAAHPgAA3Sl3YAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAESoJUUDAAATd6GGSXoZ7vQ1ZZfA+APz78U9R/2HT4dv887vs+F/dn5LOaS5R+i/ivmk9Rp8ceP3Db/9Z+aZ5duDxf1lnm/ULV/DiepX7+Vbfw0Tm5Nts0zmkrbMs0qo5pN+LOGzT+WHPsTnGTVM0TyLlJ8J0WT/AEOec/ExJlDadM3PxZreWk2uWjVkySlSfg7NTyOLbT7qiPuQXt53Lbly7oranZplPtZhkzKPzX6nPPNJJqyndpHN4l0Ty7u3ga5ZVzfiqOb3stu1vsa5ZUW/UhZ9RuyT5Vvwowlmv8rNEskXVSs1SypSryKRf8LLW8bdDyvxdmp5fQ0rNJ38zHdZbN5RTklnPLLwdGEp7WmYTkmYe8vksi0yi+rptlNy8TBSaML2yUvBFU7/AIWVWfU22J+bHYxavxr+n3PM6j7T9H6epRhqVqci/gw81832X3MrjcDkcue3DWZldjxZM1tUjcvUbs1Z9Vo9LHfrNXiwRfZzdX8vM+O1vtV1jW74aeUdHB9tiuf/AKvD6Hm+51Oae/LKU5S7uXdnadP9D5ssRflW7f0+W94vp/Lk1OadQ+m1vtposTlj6fpsmpl4Tk/dwf8Ad/ofP9R6/wBa6o9mTUvHi/8ACw/BH6+L+rMsXSpzVqSvx4PV0/RXKajtSO04PpngcDzWm5/Mug43SONxvaNz+r5vDo8mW7u/NnVg6ZkXk93ofW6X2fayJWvsexg9nFtU6j9jf1xRWNQ2MUivs+Q0nRlJKGxfM9nS9DpqG1fOj6zB0J/+HfbtE9vS9Ci/jhiin6l8UmfZLEafJaLoNKaqPZeB9DouhNRUtqdeFH0ul6G3G5Y19z2dJ0SckpOKpeFE9MU/K+KPl9L0V1J7Uu3ZHvaPpLUox29j3MHSEo7ZQSXmevpekpOX7teBkVw7XdrxtL0ppye31PV0fS5bL2dz18GgjGO2WNKj0dPoYe7jtpfQnrh0kiv5eZpun7eHLv4JHqYNHGEdrOvHov5qflx2O7DpPh5hfpXYmpj0kiHHg0+7iHFdz0sWn3U3Kr9Dfi0ja5qJ3YsD2rivQmiul8RtzYdK1TR2Y8CXhyboYVFVFG2OJJ2o/qXEzprhj8l+psjjXkZqKRnt9SkTsmdMVH0MtvqUFVRKgAABlt9Rt9QIlZdvqUAAAABE7KAAAAESooAAACJ2UjVgUAAAAAAAAAAACJUBQAAAAAAAARKigAAAI3RQAAAAAAAAAAAAAAAAAAAAAAARKigAAAAAEasoAAAAAAAAAAAAAAAAI1YFMWqMgBgAAMTTm4xtmyRqzf7uX/KUmdKTOn5F+Kc76rhx/wD06/8AefnuoaU3xwfoH4oP/wDGsH/9Vf8AuZ+e5Jru14HhXqy3/uWRwnOnfJv+7iyyblb+hzZG/M2ZJW34U2c+WW5NWcdklj2t2wxlKuDnnJPcvLx8zLLNRRy5J7Y2Ys28MS99jl6GnNNqDfiYPNL+I0zy3+ZkPdti2vMDyNu5eDs15MqknL9CZZ7VfmcmTJu+GuxSbaRzfTdPJxS8TQ58UzFz4t+BqlKiP3naKb7bXk47GHvlfLr6GqWTb4Bz73xSLqwti8tm5W6MVkvujXFyavsTLmxYI782SMI+cnRPTBfJOqxuVIi151WNtqbd2zGMbvk8fUe1OmwTrRQlmkv4rqD/ALs8rV67qfUqhlyyxw8IQdL6+Z1HT/SPM5cxa8dsfq2fG6LyOR5t4h9Pq+q9O0Cb1WqhF/yrmT+iPB1XtlnyKWPp2k2J9smZ3/8AYv7s4MXTHLmUbPR0/Q90VJL9DsOD6N4mGe7L90x/k3fH9O4aTu8zMvG1Go6l1KW/WanJkfknUF/5VwZ4Olzm7jHsfT6LoEsmRbYLg97R+zu7IveQXHY67Bw8XHr24qxEN7g4ePDGqxp8Xp+h5MjtbVXoexo+g75bpQuj7TD7PSh+XAuT1dJ0CTi5Shtv0szIx7ZcRt8dp+gut+PEr9T19F7PxW34PtwfZ6XoW2MXtT+h6el6KpScqary4JYwyr26fI4egRTbcLaPU03Q1vX7tfY+s03RorH+Q9LD0hRafu0S1wropt8vpOhr4v3a8PD5nq6PoyilH3S5PotP0+uNnD9Ox26fQecdv9yamH8r+3TwsHSNlr3adnqYel4ml8P6Hr4dClVNHbg0SdU0T1xQvisPIxdOjXxLdfY7sOit/wCR6mPSKNXb+SOnHpfBJEkU0v7Xnw0tv8qX0OzHp7a+Bcnbj0fPNHRi0q4XBJELtOXDpPiTaR2Y9P5RR0w0yUUuODfDCkuyK6VaIad8HRGHoZqCXYzUUioxjBGaVAAAVKypUBilRklRSNWBQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEasoAAAAAAAAAAAAAAAAAAAAFy6D4k4+QAAAAABgZgAAAAAAAAidgUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAjdFMe4EAAGDVmjO/hl8joao58/5JP/hKStt7Px78UP8A9X0z/wDpV/7mfnmfg/RPxSW3qulfe9L/AP6Z+c55eh4N6strqWX93Cczxyb/ALvPyS5OXLNRtG7JNbmmcWWdN8c+Ds4u8yw8ltQxyyuqd/Q5c2VKD2s2Tm06RxZ3aSXHFEEztg2skpcepz5MiTdvsXJOl2OacrTXmRse1vOyWWTqLfw12Nbk2mk6MXK5KJik+eStabnUIbbn2hlO9u2PdjJLbXwt/JGvLnwYG1nmoSj/AA939jgzdZzZE8el0qSl2nk5/RP+5uOH0Plcyf6dJ/dk8fgZ+RP2Vdr7nJqeq6LCpJZt01/DFX+vb9Thlh1uq/8AzOXf5cUl9Edmm6DlyS/KuPQ7TgeiKx55Nv8AJveN6em/3ZpcGfrPUM7lHT4Y4Em0pL4pfdnFDQZ9XkbzZMmSUvGTs+uwezuWclHZGP0PY03s1Lc5ThF0drwui8XhRrHSP3dFx+nYePGqVfEaXoEnFxlCTryPW0vs/K/hx18j7rS+z0FjuWKKs9bS+ziUVJYY8G1x44j2Z1aPgtP7PTablFuvQ93S+zs4Jvb3rwPtcPQHGO6OGK3Hq6foySa2R5Jq4dey+KS+NwezbjK4wqvA9bT9Anv3bVx6H1WHoyab2xPT03R04L4Ik1MMr4rp8rj6LNpP3aPS0/Rty3Rgn/Y+lx9KSX+7jx6nfj6ZGHMZd/MnrhXVrry+axdHXG5V9D0MHTIfyd/Q92HT123x+x149Gu6cSaMK7th4uDp6p7UkdeDQbU3GKX0PWhpFXf7o349LS4aL4xxVdFdPNxaFtcxOrHoqfK7HetPJdmmboaaXmi/t/K7Thx6aMX+R/Y6Iaa0qpHbDA0qs2w07femXaNOTFppLs0dGPSO+GjqjgXarNsMVPsU91XPDTNPlo6MeLalbNix14GyMfUuGMIUuxsSpAAADKIGIMwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAInYFAAAAAAAAAAAAAAAAAAAALiSkALL87IAAAAAAAAAAAAjVlAAAAAAAABG6AoAAAAAAAAAAAAACN0UAAAAAAAidlAAACNWYmUjEAAAJI5tRG4N34HTI05IuUGl5FJnSkxt+Q/ipCtdoZ3+bTyX/wBz/wAT8w1HY/V/xZxxjDps3Hj99BvyXws/JtY6Tr1PBfW1ezql4/b/AGcP1GvbyrvNzTp8cs4cs+WdWak1XeueDhy8co4e19tRls555JbpcnJmyO47X5nRl/Ozg1WojiScYvJPm4wV19exNxuJm5duzFWZlDXFfLPbSNkpNrjg58mbHjp5ckYLzZomupaxViisEX/Krl9zLTdAy55/vFKT85OzsuneieRm1fkz2x+PlteP0DLl85fDjy9YwxlWnwZMkl+VtUvt3MFl6hrdzc/dLxUOH9+/6n0On9mMm/dtXw+h7ui9m5SUV7tX50dtwPSvB4WprTc/mW94/RuPhj2fD6bomTJXwVfdnt6X2Z3XUUq9D7nR+y7T+OEXt9D2NN7PR8MS5Ojx8auPxENpjw1rGoh8HpPZpbGo40q78HtaP2ekoL4F9j7fSdBW3b7lcHfpuhqD/Ko36GTXBv4T1pHw+O0vs/LbGPu1z6HqaboL+K8a8PA+twdLSrj8vod2Lp6tPYieMEq9j5XTdEjt2VHj0PSwdIg7+FH0eLpypfCdWLp6TS29iWuGIVrV8/i6VaXKr0O3B09t8pceR7cNAuPgR1YdJt7ruSxjiPhfFdPGw9OpdlydmPQ7b+H9T1Y6RS4bT8jojp4vyLopEfBp5EdE21cbOnHpFz4nprTR8ODbDTxV8eJdpXTzoaRfyG6OmklSikd8cEY8pI2xx/Iv0u9nDHTPxVm+GBJeC+h2RxVfb7G2OH1X2ETtVyRwL0+xn7hea+x1qFF2IqpEaaFgj4JGaxX4o3KKYUUwqwWOjKEFZlt9SgKoAADMAAAAABGrAoBG6AoAAAAARuigAAAAAAAAAAAABGrAoAAAAAAVbf4nQEAI3QFAAAAAAAAAAAAAAAABG6KAAAAidlAAAAAROygAAAAAAceIIlQFe3wdgAAAABE7KAAAAAAAAAAAAAAAARqwKCNWUAAAAAAAACNWRqjIm31AxAAEka8itUmbJGLju4uikxsfBfiV0afUegyy4sUpZdDk98lFW3GnGVfR39D8N1MPgb9D+ps+COSLUknfB8T1L8N/ZLV6ieszdOlGT7wx5ZQh9kzz71Z6SzdZz15HFtET7TtoOpdLtyL/AFMUv54lp8+ozrBpcM8uafbHCLlJ/RI7MPsr1GWJZNalp77RVTkvnTpH7n/8tdK6diem6X0/BpoXcvdQpy8tz7v6s83UdChucttX6Gu6b/D3BgmL82e+fxHsx+P0Kkfdm8y/F8vsrNyaU5ZP+d3X07Fh7KuVKeOLS9D9bydAhJ/lX2MI9ATf5V9jsuP0jBxK9uGkQ2+Lh4sP9mH5rp/ZRStPHFHp6f2YW9S91Hg+9x9Ciq+FfY9DF0WMkpe7XPoZlePMJ4pEPhMPsyot/uo8nraf2ecIpKG35PufYY+lU3WNI6I9OjFLhcehLGCYSRSHy2n6OoPtdnfpukrl7T3sfT0qdL7G+GjjHyX0Ja4de6sViHiw6alxs/U6sPTVufwHsY9F32JetnTj0kYv4Wl9CWKRCunjR6err3f6m6GhaacYpHsLS8/mX2NsdPS/MvsX9qsw8mGinXY6IaSd/lPRWC/FG1adrxRWKq6efHStVZujporuehHTrx5M46er5X2KxGiIcUMEUqN0dMvM644/kbIx+RUiHKtPFeJsjiSVJJG5RMttBVp9z6r7GfufVfY2ADFQryLVlACqJt9Rt9SgADLb6gYgy2+o2+oDb6lAAAAACJUUAAAAAAAAAAAAAAAAAAAAAAAACN0UAAAAAK38Lj5mKVAUEasoAEbooAAAAROygAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAiVFAAAAAAAAAAAASIkUAYAyboJ2Bi1Zi3Zm3ZGrA1TjwcOognJ8Hoyj6mpwT7lNfCmnh59Hy5p/Q4J6OMuyPpZ6eMuxolp0v+7RTtNPnf9nlx9Oviv0Pf/Y/+BfYy/Zkv4UU1s08WPT1FU4Jm1aLiqR6v7N6ozWnS8V9isVNPIjo+/wANG39jj5Hqx08PFF/Z4eQ7TTzY6NeRtWjSd7D0Y41VJJF936ouIjTjhpEv4TZHSrm4nZHG/MzjjfmFXIsNdoIqw33SR1bfUbfUDUsVeKCxNeJuAGtRM9tFABKgAAAKlYEBmAMDKJQBGrCVFAAAAAAAAAAAAROygAAAABEqKALfwuPmQAAAAAAAAAAAAAAAAAAABG6KAAAAAAAAAAAAAAACN0UAAAAAAAAAAAAAAEasoAAAAARqygYAzAAAAAAAAAAAAAAAI3RQAAAAAAAAAAAE3ehSbfUoAAiVAUAAAAAAI3QFAAAkikasDEAACbfUoA17bJ7teRtJt9QNez0J7tXdG4Aati/lLsRsAGCikKXkZgCRS8ht9SgAAAAAAAGYGAMwBNvqUACJ2UAAAAAAAjdFAAAAAAAAAAAAACNWUAAAJEoJICgAAAAAAAAAAAAAAAAAAAAAInZQAAAAAAAAAAAAAAAAABGrANWUiVFAAidlAAAAAABEqKAAAAjVlAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACJ2UAAAAAAAAARqygCbfUbfUpGrAbfUbfUpG6AxAAAGYAxaohmAMDLb6lAE2+o2+pQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEasoAAAAAAIlRQAAAAAAARKigCNWUAAAAAAAAAAAAAAAAAAABIlBIgUAACN0UACNWUAAAAAAAAAACNWBQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEasoAAAAAAAAAAAAAAAAInYFAAAAAARuigAAAAAAAjVgUAAAAAAAAAAAABEqKAAAAAAAAAAAAAAjdAUAAAAAAAEasoAAAAAAAAAAAAAAAAIlQFAAAAAAAAAAAAAAAAAAAAiVAUiVFAAAARKigAAAAI1ZQAAAAAAACNWBQAABGrKAAAAETsoAAAACJUBQAAAAAidlAAAAACJUBQRuigAABE7DdBuigARqygAAAAAAAAAAAAInYFBG6KAAAAAAAAAJt9SgAAAInZQAAAAAAAAABNvqUidgUAAARqygAAAAAAAAAAAAAAAAAAAIlRQAAAAAAAAAAInYFAIlQFInY2+pQAIlRQAAAAjdFAAiVFAAAAAAAAAAAAAABE7KAAAAAAAAAAAAAiVFAfMPb4KgAAAAAAAAAAKu6+ZJfnYAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAInZQABGrKAAAAAARuigAAAAAAAAAARqygAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACJ2UjVgUAAAAAAAAAAAAAAAAiVFAAAAAAAAAAAAAAAAAAAAFw7LfDXm7IAAAAAAAAAAAAAACJ2UAAARKgKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAARqwKAAAAAAAAROygAAABGrKAAAAAAAAAInZQAAAAAAAAAAAAESooAiVFuS7MACbvQbfUoAAAAAAAAAAAAAAAAAAAAAAAAAAETsCgEboCgAAAAAAAAETsCgAAAAAAAAAAAAAAAETsoAAAAAAAAAEbooAAAAAAAAAAAAAAAAAAAAAAAAAAidlAAAAAROwKCJ2UAAAAAAAjVhugKAAAAAAAAAAAAAAAAAAI1ZQAAAAAAAAROwKAAAAAAAAAAAAAAAAuXQfdryAAAAAAAAAAAAAAAAAAAAAAABGrKAAAAAAAAAAAAAAACNWUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAm31KCbfUBEoJECgAARKigAAAAAAAAAAABGrKAIlRSNWE7AoAAFv4XHzIAJEoAAAAAAAAAAAAAAAAI3QBqygAT8pQAAAAAjdFAAAB8hcn3dgAAAAAAAAAAAAAAAAAAAAAAAAAAAuHYAB8ycvMAAAAAAAAAAAAAI3QFAAAAAAROygAAAAAAAAARKg1YFAAAm31KAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABE7KAAAAAAAAAAAAAAAAAAAAAjdBqwKAAAAAAACNWUAACNWE7AoAAAAAAAAAAALl0HxJx8gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACJUUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAARuik2+oFAIlQFAAAGfu/UwAAAAAABG6CVFAAAAAAAAAAACJ2UAAAROwDVlAAjVlAAAAAAAAAAAAAAAAAAAAAAAAAAAACN0UAAAAAAAAAAAAAAAAAAAAAAAAAARqygAAAAAAAAAAAAAAd+F38gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAI3RQAC4dgAJfFJsAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAjVgUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAInZQAAAAAAAAAAAAAAACJ2BQAAAAAAAAAAAAAAAAAAAAAjVlAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABG6KAAAAAAAAAAAAAAAAAAAAiVFAAAjVgUAAAAAI3RQAAAAAAAAAI1ZQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAI1ZQAAAAAAAAAAAAAABz4AALfi7AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABE7KFw7LL87AgAAAAAAAABEqAoAAAESoCgAACN0UAAAAAAAAACREQKAAAAAEasNWUCNWUAAAAAC5dB8ScfICJUUAAAAI1ZQAAAAAAAAAAAAAAAAAAAAAACJUE7DVhugKAAAInZQAIlRQAAAAACSKCRAoI3RQBE7KAAAAAAAAABGrKAAAAAAARqygAAAAI1ZQAAAAAAAAAAAAAAAAAAAAEasCgAAAAAAAAESoCgkRECgAAAAAAAAAAARKgKAAAAAAAARqygCJUUAACNWUAAAAAAEkUkgKAAAAAAAAAAAAAAAAARKgKAAAAAAAAAAI1ZQAAAAAACREigAARKgKAAAAAAjVlAkRESEgKAAABG6AoBNvqBQAAI1ZQBEqKAAAAAAAAAAIlRQAAAAESooEasNWUjVgUAAAABGrKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAARqykSooAAAAAAAAAAARqygAAAAAAAAAAAAAAESooAAArfwuPmBARKigAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACN0UAARqygAAAAAAAAAAAAAAidlI1YFAAEasoAEiJCQiBQAABGrKAAAAAAAAAAAAAAAAAAAAAAACJUBQAAAI3QBKigAAAABG6KAAI3QFAAAAAAAAAAACn3oARqw1ZQAAAAAidgUAAAAAAAAETsoALh2AAfMnLzAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABGrKRKigAAAAAETsoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACJUUAARqygARuigAAABE7CdgUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHPgAAuf8zAAAAAACJUBQAABE7KAAAAAAAAABG6KAAAAAAAAAAAAAAARqygAAB//2Q==";

// Helper function to get logo as base64 data URI
async function getLogoBase64(): Promise<string> {
  try {
    // Primary: Use hardcoded base64 logo (always available)
    if (ALTHEA_LOGO_BASE64 && ALTHEA_LOGO_BASE64.length > 100) {
      console.log("Using hardcoded base64 logo");
      return `data:image/jpeg;base64,${ALTHEA_LOGO_BASE64}`;
    }

    // Fallback: Return a small placeholder if somehow the constant is missing
    console.warn("Logo base64 constant missing, using placeholder");
    return "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgZmlsbD0iIzIyYzU1ZSIvPjx0ZXh0IHg9IjUwIiB5PSI1NSIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjI0IiBmaWxsPSJ3aGl0ZSIgdGV4dC1hbmNob3I9Im1pZGRsZSI+QTwvdGV4dD48L3N2Zz4=";
  } catch (error) {
    console.error("Error in getLogoBase64:", error);
    // Return minimal SVG placeholder on any error
    return "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgZmlsbD0iIzIyYzU1ZSIvPjwvc3ZnPg==";
  }
}

// Transform insights data directly to report format (no regeneration)
function transformInsightsToReportFormat(insights: any): ReportSection {
  console.log("Transforming existing insights to report format");
  console.log("Insights structure:", JSON.stringify(Object.keys(insights), null, 2));

  // Build enhanced executive summary from structured data
  let executiveSummary = "";

  if (insights.enhanced_summary && Object.keys(insights.enhanced_summary).length > 0) {
    const es = insights.enhanced_summary;
    const parts = [];

    if (es.greeting) parts.push(`<p class="greeting">${es.greeting}</p>`);
    if (es.overall_assessment) parts.push(`<p><strong>Overall Health Status:</strong> ${es.overall_assessment}</p>`);
    if (es.body_response_pattern) parts.push(`<p><strong>Body Response Pattern:</strong> ${es.body_response_pattern}</p>`);
    if (es.positive_signs && es.positive_signs.length > 0) {
      parts.push(`<p><strong>Positive Signs:</strong> ${es.positive_signs.join(", ")}</p>`);
    }
    if (es.health_story_context) parts.push(`<p><strong>What This Means for You:</strong> ${es.health_story_context}</p>`);
    if (es.key_message) parts.push(`<p class="key-message">${es.key_message}</p>`);

    executiveSummary = parts.join("\n");
  } else {
    // Fallback to basic summary if enhanced_summary not available
    executiveSummary = `<p>${insights.summary || insights.executive_summary || insights.overview || "Comprehensive health analysis based on your medical reports."}</p>`;
  }

  // Map insights structure to report structure with flexible field mapping
  const reportContent: ReportSection = {
    executive_summary: executiveSummary,
    key_findings: {
      genetic: [],
      lifestyle: [],
      risk_factors: []
    },
    abnormal_values: insights.abnormal_values || insights.abnormalValues || [],
    health_recommendations: insights.health_recommendations || insights.recommendations || [],
    family_screening: insights.family_screening_suggestions || insights.family_screening || [],
    follow_up_timeline: insights.follow_up_timeline || insights.followup_timeline || "Please consult with your healthcare provider to discuss these findings and establish an appropriate follow-up schedule."
  };

  // Transform key_findings array to categorized object - handle various formats
  const keyFindings = insights.key_findings || insights.keyFindings || insights.findings || [];

  if (Array.isArray(keyFindings) && keyFindings.length > 0) {
    console.log(`Processing ${keyFindings.length} key findings`);

    keyFindings.forEach((finding: any) => {
      const category = (finding.category || finding.type || '').toLowerCase();

      const mappedFinding = {
        finding: finding.finding || finding.description || finding.title || '',
        significance: finding.significance || finding.explanation || finding.details || '',
        action: finding.action_needed || finding.action || finding.recommendation || ''
      };

      if (category.includes('genetic') || category.includes('family') || category.includes('hereditary')) {
        reportContent.key_findings.genetic.push(mappedFinding);
      } else if (category.includes('lifestyle') || category.includes('diet') || category.includes('exercise') || category.includes('nutrition')) {
        reportContent.key_findings.lifestyle.push(mappedFinding);
      } else if (category.includes('risk')) {
        reportContent.key_findings.risk_factors.push(mappedFinding);
      } else {
        // Default to lifestyle if category unclear
        reportContent.key_findings.lifestyle.push(mappedFinding);
      }
    });
  } else {
    console.log("No key findings array found or empty, using empty arrays");
  }

  console.log(`Transformation complete: ${reportContent.key_findings.genetic.length} genetic, ${reportContent.key_findings.lifestyle.length} lifestyle, ${reportContent.key_findings.risk_factors.length} risk findings`);

  return reportContent;
}

// DEPRECATED: This function is kept for reference but should NOT be called
// to avoid regenerating content that differs from what user sees on screen
async function generateReportContent(
  labReports: any[],
  testResults: any[],
  patient: any,
  insights: any
): Promise<ReportSection> {
  const openaiKey = Deno.env.get("OPENAI_API_KEY");
  if (!openaiKey) {
    throw new Error("OPENAI_API_KEY not configured");
  }

  const systemPrompt = `You are a medical report generator creating comprehensive health reports.

Generate a structured health report with these EXACT sections:

1. EXECUTIVE SUMMARY (2-3 sentences overview)
2. KEY FINDINGS BY CATEGORY (organized by: genetic, lifestyle, risk_factors)
3. ABNORMAL VALUES ANALYSIS (with clinical explanations and reference ranges)
4. PERSONALIZED HEALTH RECOMMENDATIONS (3-5 actionable items)
5. FAMILY SCREENING SUGGESTIONS (genetic counseling recommendations)
6. FOLLOW-UP TIMELINE (specific dates and intervals)

OUTPUT FORMAT (JSON):
{
  "executive_summary": "2-3 sentence overview",
  "key_findings": {
    "genetic": [{"finding": "...", "significance": "...", "action": "..."}],
    "lifestyle": [{"finding": "...", "significance": "...", "action": "..."}],
    "risk_factors": [{"finding": "...", "significance": "...", "action": "..."}]
  },
  "abnormal_values": [{
    "test_name": "...",
    "value": "...",
    "reference_range": "...",
    "clinical_explanation": "...",
    "severity": "high/medium/low"
  }],
  "health_recommendations": [{
    "recommendation": "...",
    "rationale": "...",
    "priority": "high/medium/low",
    "timeline": "..."
  }],
  "family_screening": [{
    "condition": "...",
    "recommendation": "...",
    "family_members": "...",
    "urgency": "..."
  }],
  "follow_up_timeline": "Detailed schedule with specific dates"
}`;

  const testSummary = testResults.map(test => ({
    test: test.test_name,
    value: test.observed_value,
    unit: test.unit,
    range: test.reference_range_text,
    status: test.status,
    category: test.test_category
  }));

  try {
    const response = await fetch("https://api.openai.com/v1/chat/completions", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "Authorization": `Bearer ${openaiKey}`,
      },
      body: JSON.stringify({
        model: "gpt-4o-mini",
        messages: [
          {
            role: "system",
            content: systemPrompt,
          },
          {
            role: "user",
            content: `Generate a comprehensive health report for:

PATIENT: ${JSON.stringify(patient, null, 2)}

TEST RESULTS (${testResults.length} tests):
${JSON.stringify(testSummary, null, 2)}

EXISTING INSIGHTS:
${JSON.stringify(insights, null, 2)}

Generate the structured report in JSON format.`,
          },
        ],
        temperature: 0.3,
        response_format: { type: "json_object" },
      }),
    });

    if (!response.ok) {
      throw new Error(`OpenAI API error: ${response.status}`);
    }

    const result = await response.json();
    const reportContent = JSON.parse(result.choices?.[0]?.message?.content || "{}");
    return reportContent;
  } catch (error: any) {
    console.error("Error generating report content:", error);
    throw error;
  }
}

async function generateQuestions(
  reportContent: ReportSection,
  testResults: any[]
): Promise<any[]> {
  const openaiKey = Deno.env.get("OPENAI_API_KEY");
  if (!openaiKey) {
    throw new Error("OPENAI_API_KEY not configured");
  }

  const systemPrompt = `Generate 3-5 clinically relevant questions a patient should ask their doctor.

REQUIREMENTS:
- Based on actual test results and findings
- Prioritize by clinical significance (high, medium, low)
- Encourage patient engagement
- Help clarify health concerns
- Specific to the patient's results

OUTPUT FORMAT (JSON):
{
  "questions": [{
    "question": "Specific question text",
    "priority": "high/medium/low",
    "category": "genetic/lifestyle/follow_up/general",
    "clinical_context": "Why this question matters"
  }]
}`;

  try {
    const response = await fetch("https://api.openai.com/v1/chat/completions", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "Authorization": `Bearer ${openaiKey}`,
      },
      body: JSON.stringify({
        model: "gpt-4o-mini",
        messages: [
          {
            role: "system",
            content: systemPrompt,
          },
          {
            role: "user",
            content: `Based on this health report, generate 3-5 priority questions:

ABNORMAL VALUES:
${JSON.stringify(reportContent.abnormal_values, null, 2)}

KEY FINDINGS:
${JSON.stringify(reportContent.key_findings, null, 2)}

Generate the questions in JSON format.`,
          },
        ],
        temperature: 0.4,
        response_format: { type: "json_object" },
      }),
    });

    if (!response.ok) {
      throw new Error(`OpenAI API error: ${response.status}`);
    }

    const result = await response.json();
    const questionsData = JSON.parse(result.choices?.[0]?.message?.content || '{"questions":[]}');
    return questionsData.questions || [];
  } catch (error: any) {
    console.error("Error generating questions:", error);
    return [];
  }
}

async function generateHTMLReport(
  reportContent: ReportSection,
  patient: any,
  reportMetadata: any,
  logoBase64: string,
  aiInsights?: any
): Promise<string> {
  const html = `
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Althea Health Report - ${reportMetadata.reportId}</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      line-height: 1.6;
      color: #333;
      background: #fff;
      padding: 40px;
      max-width: 1000px;
      margin: 0 auto;
    }
    .brand-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 20px;
      padding: 20px;
      background: linear-gradient(135deg, #f0fdf4 0%, #d1fae5 100%);
      border-radius: 12px;
      border: 2px solid #10b981;
    }
    .brand-logo-section {
      display: flex;
      align-items: center;
      gap: 15px;
    }
    .brand-logo {
      width: 60px;
      height: 60px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .brand-logo img {
      width: 100%;
      height: 100%;
      object-fit: contain;
    }
    .brand-name-section {
      display: flex;
      flex-direction: column;
    }
    .brand-name {
      font-size: 28px;
      font-weight: bold;
      color: #10b981;
      letter-spacing: -0.5px;
    }
    .brand-tagline {
      font-size: 13px;
      color: #059669;
      font-style: italic;
    }
    .report-title {
      text-align: right;
      color: #6b7280;
    }
    .report-title h2 {
      font-size: 18px;
      font-weight: 600;
      color: #374151;
      margin-bottom: 4px;
    }
    .report-title p {
      font-size: 12px;
      color: #6b7280;
    }
    .header {
      border-bottom: 4px solid #10b981;
      padding-bottom: 20px;
      margin-bottom: 30px;
    }
    .header h1 {
      color: #10b981;
      font-size: 32px;
      margin-bottom: 10px;
    }
    .metadata {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 10px;
      font-size: 14px;
      color: #666;
    }
    .section {
      margin-bottom: 40px;
      page-break-inside: avoid;
    }
    .section-title {
      color: #10b981;
      font-size: 24px;
      margin-bottom: 15px;
      padding-bottom: 10px;
      border-bottom: 2px solid #e5e7eb;
    }
    .executive-summary {
      background: #f0fdf4;
      padding: 20px;
      border-left: 4px solid #10b981;
      font-size: 16px;
      line-height: 1.8;
    }
    .finding-category {
      margin-bottom: 20px;
    }
    .finding-category h3 {
      color: #059669;
      font-size: 18px;
      margin-bottom: 10px;
    }
    .finding-item {
      background: #f9fafb;
      padding: 15px;
      margin-bottom: 10px;
      border-left: 3px solid #10b981;
    }
    .abnormal-value {
      background: #fef2f2;
      border-left: 4px solid #ef4444;
      padding: 15px;
      margin-bottom: 15px;
    }
    .abnormal-value.medium {
      background: #fefce8;
      border-left-color: #f59e0b;
    }
    .abnormal-value.low {
      background: #eff6ff;
      border-left-color: #3b82f6;
    }
    .abnormal-value h4 {
      color: #1f2937;
      margin-bottom: 8px;
    }
    .value-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 10px;
      margin: 10px 0;
      font-size: 14px;
    }
    .recommendation {
      background: #fefce8;
      border-left: 4px solid #eab308;
      padding: 15px;
      margin-bottom: 15px;
    }
    .recommendation.high-priority {
      background: #fef2f2;
      border-left-color: #ef4444;
    }
    .priority-badge {
      display: inline-block;
      padding: 4px 12px;
      border-radius: 12px;
      font-size: 12px;
      font-weight: bold;
      text-transform: uppercase;
    }
    .priority-high { background: #fee2e2; color: #991b1b; }
    .priority-medium { background: #fef3c7; color: #92400e; }
    .priority-low { background: #dbeafe; color: #1e40af; }
    .family-screening {
      background: #f5f3ff;
      border-left: 4px solid #8b5cf6;
      padding: 15px;
      margin-bottom: 15px;
    }
    .timeline {
      background: #f0fdfa;
      padding: 20px;
      border-left: 4px solid #14b8a6;
      font-size: 15px;
      line-height: 1.8;
    }
    .ai-insights {
      background: #faf5ff;
      border-left: 4px solid #a855f7;
      padding: 15px;
      margin-bottom: 15px;
    }
    .question-item {
      background: #f9fafb;
      padding: 12px;
      margin-bottom: 10px;
      border-radius: 8px;
      border-left: 3px solid #10b981;
    }
    .question-number {
      display: inline-block;
      width: 24px;
      height: 24px;
      border-radius: 50%;
      background: #10b981;
      color: white;
      text-align: center;
      line-height: 24px;
      font-size: 12px;
      font-weight: bold;
      margin-right: 10px;
    }
    .footer {
      margin-top: 50px;
      padding-top: 20px;
      border-top: 2px solid #e5e7eb;
      font-size: 12px;
      color: #6b7280;
      text-align: center;
    }
    .footer-logo {
      display: inline-block;
      width: 24px;
      height: 24px;
      vertical-align: middle;
      margin-right: 8px;
    }
    .disclaimer {
      background: #fffbeb;
      border: 1px solid #fde047;
      padding: 15px;
      margin-top: 30px;
      font-size: 13px;
      line-height: 1.6;
    }
    @media print {
      body { padding: 20px; }
      .section { page-break-inside: avoid; }
    }
  </style>
</head>
<body>
  <div class="brand-header">
    <div class="brand-logo-section">
      <div class="brand-logo">
        <img src="${logoBase64}" alt="Althea Logo" />
      </div>
      <div class="brand-name-section">
        <div class="brand-name">Althea</div>
        <div class="brand-tagline">Your Personal Health Interpreter</div>
      </div>
    </div>
    <div class="report-title">
      <h2>Comprehensive Health Report</h2>
      <p>Generated ${new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}</p>
    </div>
  </div>

  <div class="header">
    <h1>Patient Health Summary</h1>
    <div class="metadata">
      <div><strong>Patient:</strong> ${patient?.name || 'N/A'}</div>
      <div><strong>Report ID:</strong> ${reportMetadata.reportId.substring(0, 8)}</div>
      <div><strong>Generated:</strong> ${new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}</div>
      <div><strong>Version:</strong> ${reportMetadata.version}</div>
    </div>
  </div>

  <div class="section">
    <h2 class="section-title">1. Executive Summary</h2>
    <div class="executive-summary">
      ${reportContent.executive_summary}
    </div>
  </div>

  <div class="section">
    <h2 class="section-title">2. Key Findings by Category</h2>

    ${reportContent.key_findings.genetic?.length > 0 ? `
    <div class="finding-category">
      <h3>Genetic Factors</h3>
      ${reportContent.key_findings.genetic.map(f => `
        <div class="finding-item">
          <strong>Finding:</strong> ${f.finding}<br>
          <strong>Significance:</strong> ${f.significance}<br>
          <strong>Action:</strong> ${f.action}
        </div>
      `).join('')}
    </div>
    ` : ''}

    ${reportContent.key_findings.lifestyle?.length > 0 ? `
    <div class="finding-category">
      <h3>Lifestyle Factors</h3>
      ${reportContent.key_findings.lifestyle.map(f => `
        <div class="finding-item">
          <strong>Finding:</strong> ${f.finding}<br>
          <strong>Significance:</strong> ${f.significance}<br>
          <strong>Action:</strong> ${f.action}
        </div>
      `).join('')}
    </div>
    ` : ''}

    ${reportContent.key_findings.risk_factors?.length > 0 ? `
    <div class="finding-category">
      <h3>Risk Factors</h3>
      ${reportContent.key_findings.risk_factors.map(f => `
        <div class="finding-item">
          <strong>Finding:</strong> ${f.finding}<br>
          <strong>Significance:</strong> ${f.significance}<br>
          <strong>Action:</strong> ${f.action}
        </div>
      `).join('')}
    </div>
    ` : ''}
  </div>

  ${reportContent.abnormal_values?.length > 0 ? `
  <div class="section">
    <h2 class="section-title">3. Abnormal Values Analysis</h2>
    ${reportContent.abnormal_values.map(v => `
      <div class="abnormal-value ${v.severity}">
        <h4>${v.test_name}</h4>
        <div class="value-grid">
          <div><strong>Your Value:</strong> ${v.value}</div>
          <div><strong>Reference Range:</strong> ${v.reference_range}</div>
        </div>
        <p><strong>Clinical Explanation:</strong> ${v.clinical_explanation}</p>
        <span class="priority-badge priority-${v.severity}">${v.severity} Priority</span>
      </div>
    `).join('')}
  </div>
  ` : ''}

  ${reportContent.health_recommendations?.length > 0 ? `
  <div class="section">
    <h2 class="section-title">4. Personalized Health Recommendations</h2>
    ${reportContent.health_recommendations.map((r, idx) => `
      <div class="recommendation ${r.priority === 'high' ? 'high-priority' : ''}">
        <strong>${idx + 1}. ${r.recommendation}</strong>
        <p><strong>Rationale:</strong> ${r.rationale}</p>
        <p><strong>Timeline:</strong> ${r.timeline}</p>
        <span class="priority-badge priority-${r.priority}">${r.priority} Priority</span>
      </div>
    `).join('')}
  </div>
  ` : ''}

  ${reportContent.family_screening?.length > 0 ? `
  <div class="section">
    <h2 class="section-title">5. Family Screening Suggestions</h2>
    ${reportContent.family_screening.map(s => `
      <div class="family-screening">
        <h4>${s.condition}</h4>
        <p><strong>Recommendation:</strong> ${s.recommendation}</p>
        <p><strong>Family Members:</strong> ${s.family_members}</p>
        <p><strong>Urgency:</strong> ${s.urgency}</p>
      </div>
    `).join('')}
  </div>
  ` : ''}

  <div class="section">
    <h2 class="section-title">6. Follow-up Timeline</h2>
    <div class="timeline">
      ${reportContent.follow_up_timeline}
    </div>
  </div>

  ${aiInsights ? `
  <div class="section">
    <h2 class="section-title">7. AI Health Insights (Step 3 Analysis)</h2>

    ${aiInsights.summary ? `
    <div class="ai-insights">
      <h3 style="color: #8b5cf6; margin-bottom: 10px;">AI-Generated Summary</h3>
      <p>${aiInsights.summary}</p>
    </div>
    ` : ''}

    ${aiInsights.questions_for_doctor?.length > 0 ? `
    <div class="ai-insights">
      <h3 style="color: #8b5cf6; margin-bottom: 10px;">Questions for Your Doctor</h3>
      ${aiInsights.questions_for_doctor.map((q: string, idx: number) => `
        <div class="question-item">
          <span class="question-number">${idx + 1}</span>
          ${q}
        </div>
      `).join('')}
    </div>
    ` : ''}

    ${aiInsights.health_recommendations?.length > 0 ? `
    <div class="ai-insights">
      <h3 style="color: #8b5cf6; margin-bottom: 10px;">Additional AI Recommendations</h3>
      ${aiInsights.health_recommendations.map((rec: any, idx: number) => `
        <div class="recommendation">
          <strong>${idx + 1}. ${rec.category || rec.recommendation}</strong>
          <p>${rec.recommendation}</p>
          ${rec.priority ? `<span class="priority-badge priority-${rec.priority}">${rec.priority} Priority</span>` : ''}
        </div>
      `).join('')}
    </div>
    ` : ''}

    ${aiInsights.urgency_flag && aiInsights.urgency_flag !== 'none' ? `
    <div style="background: #fef2f2; border: 2px solid #ef4444; padding: 15px; border-radius: 8px; margin-top: 15px;">
      <h4 style="color: #dc2626; margin-bottom: 8px;"> URGENCY FLAG: ${aiInsights.urgency_flag.toUpperCase()}</h4>
      <p style="color: #7f1d1d;">Some findings require timely medical attention. Please consult your healthcare provider promptly.</p>
    </div>
    ` : ''}
  </div>
  ` : ''}

  <div class="disclaimer">
    <strong>Important Disclaimer:</strong> This report is for informational purposes only and does not constitute medical advice, diagnosis, or treatment.
    Always consult with qualified healthcare professionals for medical decisions. This report is generated by AI and should be reviewed by your healthcare provider.
  </div>

  <div class="footer">
    <p>
      <img class="footer-logo" src="${logoBase64}" alt="Althea Logo" />
      <strong>Althea</strong> - Your Personal Health Interpreter | Generated on ${new Date().toLocaleString()}
    </p>
    <p>Report ID: ${reportMetadata.reportId.substring(0, 8)} | Version: ${reportMetadata.version}</p>
    <p style="margin-top: 8px; font-size: 11px;">This report is confidential and intended solely for the patient named above.</p>
  </div>
</body>
</html>`;

  return html;
}

Deno.serve(async (req: Request) => {
  if (req.method === "OPTIONS") {
    return new Response(null, { status: 200, headers: corsHeaders });
  }

  try {
    const {
      sessionId,
      reportType = "comprehensive",
      includeQuestions = true,
      forceRegenerate = false,
      insightsId
    }: ReportRequest = await req.json();

    if (!sessionId) {
      return new Response(
        JSON.stringify({ error: "sessionId is required" }),
        { status: 400, headers: { ...corsHeaders, "Content-Type": "application/json" } }
      );
    }

    const authHeader = req.headers.get("Authorization");
    if (!authHeader) {
      return new Response(
        JSON.stringify({ error: "Authorization required" }),
        { status: 401, headers: { ...corsHeaders, "Content-Type": "application/json" } }
      );
    }

    const supabaseUrl = Deno.env.get("SUPABASE_URL")!;
    const supabaseServiceKey = Deno.env.get("SUPABASE_SERVICE_ROLE_KEY")!;
    const supabase = createClient(supabaseUrl, supabaseServiceKey);

    console.log(`Processing report request for session: ${sessionId}, forceRegenerate: ${forceRegenerate}`);

    // Get existing insights to check for cached report
    const { data: existingInsights } = await supabase
      .from("health_insights")
      .select("*")
      .eq("session_id", sessionId)
      .order("created_at", { ascending: false })
      .limit(1)
      .maybeSingle();

    // Check if report already exists and should be reused
    if (!forceRegenerate && existingInsights?.report_id && existingInsights?.report_storage_path) {
      console.log(`Found cached report: ${existingInsights.report_id}, returning existing report`);

      // Verify the report still exists in storage
      const { data: reportExists } = await supabase.storage
        .from("health-reports")
        .list(existingInsights.report_storage_path.split('/')[0], {
          search: existingInsights.report_storage_path.split('/')[1]
        });

      if (reportExists && reportExists.length > 0) {
        // Get the report from database
        const { data: existingReport } = await supabase
          .from("health_reports")
          .select("*")
          .eq("id", existingInsights.report_id)
          .maybeSingle();

        // Get questions
        const { data: existingQuestions } = await supabase
          .from("report_questions")
          .select("*")
          .eq("report_id", existingInsights.report_id)
          .order("sort_order", { ascending: true });

        // Log access
        await supabase.from("report_access_log").insert({
          report_id: existingInsights.report_id,
          user_id: existingInsights.user_id,
          action: "reused_cached",
          accessed_at: new Date().toISOString()
        });

        return new Response(
          JSON.stringify({
            success: true,
            cached: true,
            report: existingReport,
            questions: existingQuestions || [],
            storage_path: existingInsights.report_storage_path,
            download_url: `${supabaseUrl}/storage/v1/object/public/health-reports/${existingInsights.report_storage_path}`
          }),
          { status: 200, headers: { ...corsHeaders, "Content-Type": "application/json" } }
        );
      } else {
        console.log("Cached report file not found in storage, regenerating...");
      }
    }

    console.log(`Generating new report for session: ${sessionId}`);

    // CRITICAL: Use existing insights data to ensure consistency
    // The downloaded report MUST match what user sees on screen
    if (!existingInsights) {
      console.error("No health insights record found for session:", sessionId);
      return new Response(
        JSON.stringify({ error: "No health insights found. Please generate insights first." }),
        { status: 404, headers: { ...corsHeaders, "Content-Type": "application/json" } }
      );
    }

    // Reconstruct insights_data from database columns since it doesnt exist in schema
    const insights_data = {
      summary: existingInsights.greeting || "",
      enhanced_summary: {
        greeting: existingInsights.greeting || "",
        overall_assessment: existingInsights.executive_summary || ""
      },
      key_findings: existingInsights.detailed_findings || [],
      abnormal_values: existingInsights.detailed_findings || [],
      questions_for_doctor: existingInsights.doctor_questions || [],
      health_recommendations: [],
      family_screening_suggestions: existingInsights.family_patterns || [],
      follow_up_timeline: existingInsights.next_steps || "",
      urgency_flag: "none"
    };
    
    existingInsights.insights_data = insights_data;

    if (!existingInsights.executive_summary) {
      console.error("Health insights record exists but executive_summary is null/empty:", existingInsights.id);
      return new Response(
        JSON.stringify({ error: "Health insights data is incomplete. Please regenerate insights." }),
        { status: 400, headers: { ...corsHeaders, "Content-Type": "application/json" } }
      );
    }
    console.log(`Found existing insights with ID: ${existingInsights.id}, proceeding with report generation`);

    // Get lab reports and patient info for metadata only
    const { data: labReports, error: reportsError } = await supabase
      .from("lab_reports")
      .select("*")
      .eq("session_id", sessionId);

    if (reportsError) throw reportsError;
    if (!labReports || labReports.length === 0) {
      return new Response(
        JSON.stringify({ error: "No lab reports found for this session" }),
        { status: 404, headers: { ...corsHeaders, "Content-Type": "application/json" } }
      );
    }

    const reportIds = labReports.map(r => r.id);
    const { data: testResults } = await supabase
      .from("test_results")
      .select("*")
      .in("lab_report_id", reportIds);

    const patientId = labReports[0].patient_id;
    const { data: patient } = await supabase
      .from("patients")
      .select("*")
      .eq("id", patientId)
      .maybeSingle();

    console.log(`Using existing insights data to create consistent report (no regeneration)`);

    // Use the SAME insights data that's displayed on screen
    // This ensures the downloaded report matches exactly what the user reviewed
    const reportContent = transformInsightsToReportFormat(existingInsights.insights_data);

    // Generate report ID and metadata
    const reportId = crypto.randomUUID();
    const reportMetadata = {
      reportId,
      version: 1,
      generatedAt: new Date().toISOString()
    };

    // Fetch logo as base64
    console.log("Fetching Althea logo for report...");
    const logoBase64 = await getLogoBase64();

    // Generate HTML report with AI insights
    const htmlContent = await generateHTMLReport(
      reportContent,
      patient,
      reportMetadata,
      logoBase64,
      existingInsights?.insights_data
    );

    // Save HTML to storage
    const userId = labReports[0].user_id;
    const storagePath = `${userId}/${reportId}.html`;

    const { error: uploadError } = await supabase.storage
      .from("health-reports")
      .upload(storagePath, new Blob([htmlContent], { type: "text/html" }), {
        contentType: "text/html",
        upsert: false
      });

    if (uploadError) {
      console.error("Storage upload error:", uploadError);
    }

    // Save report to database
    const { data: savedReport, error: saveError } = await supabase
      .from("health_reports")
      .insert({
        id: reportId,
        user_id: userId,
        session_id: sessionId,
        report_type: reportType,
        storage_path: storagePath,
        file_size: htmlContent.length
      })
      .select()
      .single();

    if (saveError) throw saveError;

    // Use questions from existing insights (no regeneration for consistency)
    let questions = [];
    if (includeQuestions) {
      // Try multiple possible field names for questions
      const existingQuestions = existingInsights.insights_data.questions_for_doctor ||
                                existingInsights.insights_data.questions ||
                                existingInsights.insights_data.doctor_questions ||
                                [];

      if (Array.isArray(existingQuestions) && existingQuestions.length > 0) {
        console.log(`Using ${existingQuestions.length} existing questions from insights (no regeneration)`);

        existingQuestions.forEach((questionItem: any, index: number) => {
          // Handle both string questions and object questions
          const questionText = typeof questionItem === 'string' ? questionItem : questionItem.question || questionItem.text || '';

          if (questionText) {
            questions.push({
              question: questionText,
              priority: index < 2 ? 'high' : index < 4 ? 'medium' : 'low',
              category: typeof questionItem === 'object' ? (questionItem.category || 'general') : 'general',
              clinical_context: typeof questionItem === 'object' ? (questionItem.context || 'Generated from health insights analysis') : 'Generated from health insights analysis'
            });
          }
        });

        // Insert questions into database
        for (let i = 0; i < questions.length; i++) {
          await supabase.from("report_questions").insert({
            report_id: reportId,
            user_id: userId,
            question_text: questions[i].question,
            priority: questions[i].priority,
            category: questions[i].category,
            clinical_context: questions[i].clinical_context,
            sort_order: i
          });
        }

        console.log(`Saved ${questions.length} questions to database`);
      } else {
        console.log("No questions found in insights data, skipping questions generation");
      }
    }

    // Note: Report is linked via session_id, no need to update health_insights
    console.log(`Report ${reportId} created for session ${sessionId}`);

    // Log access
    await supabase.from("report_access_log").insert({
      report_id: reportId,
      user_id: userId,
      action: "generated",
      accessed_at: new Date().toISOString()
    });

    return new Response(
      JSON.stringify({
        success: true,
        cached: false,
        report: savedReport,
        questions: questions,
        storage_path: storagePath,
        download_url: `${supabaseUrl}/storage/v1/object/public/health-reports/${storagePath}`
      }),
      { status: 200, headers: { ...corsHeaders, "Content-Type": "application/json" } }
    );
  } catch (error: any) {
    console.error("Generate health report error:", error);
    return new Response(
      JSON.stringify({
        error: error.message || "Failed to generate health report",
        details: error.toString(),
      }),
      { status: 500, headers: { ...corsHeaders, "Content-Type": "application/json" } }
    );
  }
});
